"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[503],{8618:function(s,i,e){e.d(i,{Z:function(){return x}});var a=e(6252),t=e(3577);const l=s=>((0,a.dD)("data-v-1bc7b8b5"),s=s(),(0,a.Cn)(),s),o={class:"navbar is-hidden-desktop"},n={class:"navbar-brand"},d={class:"navbar-item"},r={class:"label"},c=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),u=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),p=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),h=[c,u,p],m={class:"has-text-centered block",style:{padding:"5px"}},w={class:"is-hidden-mobile is-hidden-touch image image-outer is-square",style:{margin:"auto"}},v=["src"],y={key:0,class:"title is-6"},f={class:"menu-list block"},g=l((()=>(0,a._)("p",{class:"menu-label"},"General",-1))),_=l((()=>(0,a._)("p",{class:"menu-label"},"Verification and Information",-1))),b=l((()=>(0,a._)("p",{class:"menu-label"},"Support",-1))),k={class:"block has-text-centered"};function P(s,i,e,l,c,u){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("nav",o,[(0,a._)("div",n,[(0,a._)("a",d,[(0,a._)("label",r,"Dr. "+(0,t.zw)(s.$store.state.doctorName),1)]),(0,a._)("a",{role:"button",class:(0,t.C_)(["navbar-burger",{"is-active":!c.isActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbar",onClick:i[0]||(i[0]=(...s)=>u.menuNav&&u.menuNav(...s))},h,2)])]),(0,a._)("aside",{class:(0,t.C_)(["menu box",{"is-hidden-mobile":c.isActive,fixedMenu:c.isActive}]),style:{"background-color":"#D8E5FF",padding:"20px"}},[(0,a._)("div",m,[(0,a._)("figure",w,[(0,a._)("img",{class:"is-rounded image-inner",src:`http://res.cloudinary.com/leindfraust/image/upload/v${(new Date).getMonth()}${(new Date).getDate()}/assets/doctors/${c.alias}.jpg`},null,8,v)]),c.isActive?((0,a.wg)(),(0,a.iD)("h5",y,"Dr. "+(0,t.zw)(s.$store.state.doctorName),1)):(0,a.kq)("",!0)]),(0,a._)("ul",f,[g,(0,a._)("li",null,[(0,a._)("a",{onClick:i[1]||(i[1]=(...s)=>u.routeHome&&u.routeHome(...s))},"Appointments")]),(0,a._)("li",null,[(0,a._)("a",{onClick:i[2]||(i[2]=(...s)=>u.openPatientHistory&&u.openPatientHistory(...s))},"Appointment History")]),(0,a._)("li",null,[(0,a._)("a",{onClick:i[3]||(i[3]=(...s)=>u.openPatientAppointmentsCancelled&&u.openPatientAppointmentsCancelled(...s))},"Cancelled Appointments")]),(0,a._)("li",null,[(0,a._)("a",{onClick:i[4]||(i[4]=(...s)=>u.openSchedule&&u.openSchedule(...s))},"Schedule")]),_,(0,a._)("li",null,[(0,a._)("a",{onClick:i[5]||(i[5]=(...s)=>u.openProfile&&u.openProfile(...s))},"Profile")]),(0,a._)("li",null,[(0,a._)("a",{onClick:i[6]||(i[6]=(...s)=>u.openSecurity&&u.openSecurity(...s))},"Security")]),(0,a._)("li",null,[(0,a._)("a",{onClick:i[7]||(i[7]=(...s)=>u.openPayment&&u.openPayment(...s))},"Payment")]),b,(0,a._)("li",null,[(0,a._)("a",{onClick:i[8]||(i[8]=s=>this.$router.push("/contactus"))},"Contact Us")])]),(0,a._)("div",k,[(0,a._)("button",{onClick:i[9]||(i[9]=(...s)=>u.logout&&u.logout(...s)),class:"button is-link is-rounded",type:"button"},"Logout")])],2)],64)}var C=e(4239),D=e(6154),E={name:"AdminMenu",data(){return{alias:C.Z.state.alias,isActive:!0}},methods:{async logout(){C.Z.commit("alias",null),await D.Z["delete"]("/session/doctor"),await this.$router.push("/account/login")},async routeHome(){await this.$router.push(`/doctor/${this.alias}/appointments`)},async openProfile(){await this.$router.push(`/doctor/${this.alias}/profile`)},async openPatientHistory(){await this.$router.push(`/doctor/${this.alias}/appointments/history`)},async openPatientAppointmentsCancelled(){await this.$router.push(`/doctor/${this.alias}/appointments/cancelled`)},async openSecurity(){await this.$router.push(`/doctor/${this.alias}/security`)},async openSchedule(){await this.$router.push(`/doctor/${this.alias}/schedule`)},async openPayment(){await this.$router.push(`/doctor/${this.alias}/payment`)},menuNav(){this.isActive=!this.isActive}}},V=e(3744);const M=(0,V.Z)(E,[["render",P],["__scopeId","data-v-1bc7b8b5"]]);var x=M},2503:function(s,i,e){e.r(i),e.d(i,{default:function(){return Hs}});var a=e(6252),t=e(9963),l=e(3577);const o=s=>((0,a.dD)("data-v-77f6730b"),s=s(),(0,a.Cn)(),s),n={class:"main-doctor"},d={class:"columns"},r={class:"column is-2"},c={class:"column"},u={class:"section"},p=o((()=>(0,a._)("h1",{class:"title"},"SECURITY",-1))),h={class:"container box"},m={key:0,class:"message is-danger"},w=o((()=>(0,a._)("div",{class:"message-header"},[(0,a._)("p",null,"YOU ARE NOT VERIFIED ❌")],-1))),v=o((()=>(0,a._)("div",{class:"message-body"},[(0,a.Uk)(" To get verified, verify your "),(0,a._)("b",null,"email account"),(0,a.Uk)(". ")],-1))),y=[w,v],f={class:"columns"},g={class:"column"},_=o((()=>(0,a._)("h1",{class:"title"},"Change password:",-1))),b=o((()=>(0,a._)("div",{class:"block"},null,-1))),k={class:"field"},P={class:"control"},C=o((()=>(0,a._)("label",{class:"label"},"Current password",-1))),D={key:0,class:"notification is-warning"},E={class:"field"},V={class:"control"},M=o((()=>(0,a._)("label",{class:"label"},"Create new password:",-1))),x={key:0,class:"notification is-danger"},S={class:"field"},I={class:"control"},T=o((()=>(0,a._)("label",{class:"label"},"Repeat new password:",-1))),A={key:0,class:"notification is-danger"},q={class:"field"},$={class:"control"},U={class:"checkbox"},Z={class:"field"},O={class:"control"},N=["disabled"],z={key:0,class:"notification is-success"},L={class:"column"},R=o((()=>(0,a._)("div",{class:"modal-background"},null,-1))),B={key:0,class:"modal-content box section",id:"OTPModal",style:{width:"33%"}},H={key:0,class:"notification is-info is-light"},F={key:1,class:"notification is-danger"},Y={key:2,class:"field"},W={class:"control has-text-centered"},j=["disabled"],G=o((()=>(0,a._)("div",{class:"block"},null,-1))),J={key:3,class:"has-text-centered"},K=["disabled"],Q={key:0,class:"notification is-danger"},X={key:1,class:"modal-content box section",id:"OTPModal",style:{width:"33%"}},ss={key:0,class:"field"},is=o((()=>(0,a._)("div",{class:"notification is-success is-light"},"Verify your email.",-1))),es={class:"control has-text-centered"},as=o((()=>(0,a._)("div",{class:"block"},null,-1))),ts={class:"has-text-centered"},ls=["disabled"],os={key:1,class:"field"},ns={key:0,class:"notification is-info is-light"},ds={key:1,class:"notification is-danger is-light"},rs={key:0},cs={key:1},us={class:"control has-text-centered"},ps=["disabled"],hs=o((()=>(0,a._)("div",{class:"block"},null,-1))),ms={key:2,class:"has-text-centered"},ws=["disabled"],vs={key:0,class:"notification is-danger"},ys={class:"field"},fs={class:"control"},gs=o((()=>(0,a._)("label",{class:"label"},[(0,a._)("b",null,"License No.")],-1))),_s=["disabled"],bs={class:"field is-horizontal"},ks={class:"field-body"},Ps={class:"field"},Cs={class:"control"},Ds=o((()=>(0,a._)("label",{class:"label"},[(0,a._)("b",null,"Full Name:")],-1))),Es=["disabled"],Vs={class:"field"},Ms={class:"control"},xs={class:"label"},Ss={key:0,class:"has-text-success"},Is=o((()=>(0,a._)("b",null,"Verified ✓",-1))),Ts=[Is],As={key:1,class:"has-text-danger"},qs=o((()=>(0,a._)("b",null,"Requires verification ❌",-1))),$s=[qs],Us=["disabled"],Zs={key:0,class:"notification is-success is-light"};function Os(s,i,e,o,w,v){const Is=(0,a.up)("DoctorMenu"),qs=(0,a.up)("ForgotPassword");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",d,[(0,a._)("div",r,[(0,a.Wm)(Is)]),(0,a._)("div",c,[(0,a._)("section",u,[p,(0,a._)("div",h,[w.verified?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("article",m,y)),(0,a._)("div",f,[(0,a._)("div",g,[_,null!=w.gmail?((0,a.wg)(),(0,a.j4)(qs,{key:0,userType:"doctor",email:w.gmail},null,8,["email"])):(0,a.kq)("",!0),b,(0,a._)("div",k,[(0,a._)("div",P,[C,(0,a.wy)((0,a._)("input",{class:"input password",size:"5",type:"password","onUpdate:modelValue":i[0]||(i[0]=s=>w.currentPassword=s),required:""},null,512),[[t.nr,w.currentPassword]])]),w.incorrectPasswordValidate?((0,a.wg)(),(0,a.iD)("div",D,(0,l.zw)(w.currentPasswordValidateMessage),1)):(0,a.kq)("",!0)]),(0,a._)("div",E,[(0,a._)("div",V,[M,(0,a.wy)((0,a._)("input",{class:(0,l.C_)(["input password",{"is-danger":w.passwordValidate}]),size:"5",type:"password","onUpdate:modelValue":i[1]||(i[1]=s=>w.password=s),required:""},null,2),[[t.nr,w.password]])]),w.passwordValidate?((0,a.wg)(),(0,a.iD)("div",x,(0,l.zw)(w.passwordValidateMessage),1)):(0,a.kq)("",!0)]),(0,a._)("div",S,[(0,a._)("div",I,[T,(0,a.wy)((0,a._)("input",{class:(0,l.C_)(["input password",{"is-danger":w.passwordValidate}]),size:"5",type:"password","onUpdate:modelValue":i[2]||(i[2]=s=>w.passwordRepeat=s),required:""},null,2),[[t.nr,w.passwordRepeat]])]),w.passwordValidate?((0,a.wg)(),(0,a.iD)("div",A,(0,l.zw)(w.passwordValidateMessage),1)):(0,a.kq)("",!0)]),(0,a._)("div",q,[(0,a._)("div",$,[(0,a._)("label",U,[(0,a._)("input",{type:"checkbox",onClick:i[3]||(i[3]=(...s)=>v.showPass&&v.showPass(...s))}),(0,a.Uk)(" Show password ")])])]),(0,a._)("div",Z,[(0,a._)("div",O,[(0,a._)("button",{class:"button is-danger",type:"submit",onClick:i[4]||(i[4]=(...s)=>v.updatePassword&&v.updatePassword(...s)),disabled:null==w.currentPassword||null==w.password||null==w.passwordRepeat},"Confirm",8,N),w.passwordSuccess?((0,a.wg)(),(0,a.iD)("div",z,"Password has been changed.")):(0,a.kq)("",!0)])])]),(0,a._)("div",L,[(0,a._)("p",null,[w.verified?((0,a.wg)(),(0,a.iD)("a",{key:0,class:"has-text-info",onClick:i[5]||(i[5]=(...s)=>v.modalUpEditInfo&&v.modalUpEditInfo(...s))},"[Edit Information]")):((0,a.wg)(),(0,a.iD)("a",{key:1,class:"has-text-danger",onClick:i[6]||(i[6]=(...s)=>v.modalUpInfoVerify&&v.modalUpInfoVerify(...s))},"[Verify Now]"))]),(0,a._)("div",{class:(0,l.C_)(["modal",{"is-active":w.isActiveModal}])},[R,w.verified?((0,a.wg)(),(0,a.iD)("div",B,[w.codeError?((0,a.wg)(),(0,a.iD)("div",F,"You can only request a verification code once, please try again in 10 minutes.")):((0,a.wg)(),(0,a.iD)("div",H,"We have sent you a verification code on your email.")),w.codeError?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",Y,[(0,a._)("div",W,[(0,a.wy)((0,a._)("input",{class:"input",type:"number",maxlength:"4",id:"OTP","onUpdate:modelValue":i[7]||(i[7]=s=>w.OTP=s),oninput:"this.value=this.value.slice(0,this.maxLength)",disabled:w.codeError},null,8,j),[[t.nr,w.OTP]])])])),G,w.codeError?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",J,[(0,a._)("button",{class:(0,l.C_)(["button is-info",{"is-loading":w.verifyButtonLoading}]),disabled:""===w.OTP,onClick:i[8]||(i[8]=(...s)=>v.confirmOTPEditInfo&&v.confirmOTPEditInfo(...s))},"Confirm",10,K),w.incorrectCode?((0,a.wg)(),(0,a.iD)("div",Q,"Incorrect code, please check your email thoroughly.")):(0,a.kq)("",!0)])),(0,a._)("button",{class:"modal-close is-large","aria-label":"close",onClick:i[9]||(i[9]=(...s)=>v.closeModal&&v.closeModal(...s))})])):((0,a.wg)(),(0,a.iD)("div",X,[w.verifyEmailSent?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",ss,[is,(0,a._)("div",es,[(0,a.wy)((0,a._)("input",{class:"input",type:"email","onUpdate:modelValue":i[10]||(i[10]=s=>w.gmail=s)},null,512),[[t.nr,w.gmail]])]),as,(0,a._)("div",ts,[(0,a._)("button",{class:(0,l.C_)(["button is-success",{"is-loading":w.verifyButtonLoading}]),onClick:i[11]||(i[11]=(...s)=>v.sendVerificationEmail&&v.sendVerificationEmail(...s)),disabled:""===w.gmail},"Verify",10,ls)])])),w.verifyEmailSent?((0,a.wg)(),(0,a.iD)("div",os,[w.codeError?((0,a.wg)(),(0,a.iD)("div",ds,[w.emailTaken?((0,a.wg)(),(0,a.iD)("span",rs,"Email address is already taken.")):((0,a.wg)(),(0,a.iD)("span",cs,"You can only request a verification code once, please try again in 10 minutes."))])):((0,a.wg)(),(0,a.iD)("div",ns,"We have sent you a verification code on your email.")),(0,a._)("div",us,[w.codeError?(0,a.kq)("",!0):(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:0,class:"input",type:"number",maxlength:"4",id:"OTP","onUpdate:modelValue":i[12]||(i[12]=s=>w.OTP=s),oninput:"this.value=this.value.slice(0,this.maxLength)",disabled:w.codeError||""==w.OTP},null,8,ps)),[[t.nr,w.OTP]])]),hs,w.codeError?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",ms,[(0,a._)("button",{class:(0,l.C_)(["button is-info",{"is-loading":w.verifyButtonLoading}]),disabled:""===w.OTP,onClick:i[13]||(i[13]=(...s)=>v.verifyEmail&&v.verifyEmail(...s))},"Confirm",10,ws),w.incorrectCode?((0,a.wg)(),(0,a.iD)("div",vs,"Incorrect code, please check your email thoroughly.")):(0,a.kq)("",!0)]))])):(0,a.kq)("",!0),(0,a._)("button",{class:"modal-close is-large","aria-label":"close",onClick:i[14]||(i[14]=(...s)=>v.closeModal&&v.closeModal(...s))})]))],2),(0,a._)("div",ys,[(0,a._)("div",fs,[gs,(0,a.wy)((0,a._)("input",{class:(0,l.C_)(["input",{"is-success":w.authorized}]),type:"text","onUpdate:modelValue":i[15]||(i[15]=s=>w.licenseNo=s),style:{width:"33%"},disabled:!w.authorized},null,10,_s),[[t.nr,w.licenseNo]])])]),(0,a._)("div",bs,[(0,a._)("div",ks,[(0,a._)("div",Ps,[(0,a._)("div",Cs,[Ds,(0,a.wy)((0,a._)("input",{class:(0,l.C_)(["input",{"is-success":w.authorized}]),size:"5",type:"text","onUpdate:modelValue":i[16]||(i[16]=s=>w.fullname=s),disabled:!w.authorized},null,10,Es),[[t.nr,w.fullname]])])]),(0,a._)("div",Vs,[(0,a._)("div",Ms,[(0,a._)("label",xs,[(0,a.Uk)(" Email "),w.verified?((0,a.wg)(),(0,a.iD)("span",Ss,Ts)):((0,a.wg)(),(0,a.iD)("span",As,$s))]),(0,a.wy)((0,a._)("input",{class:"input",size:"5",type:"text","onUpdate:modelValue":i[17]||(i[17]=s=>w.gmail=s),disabled:""},null,512),[[t.nr,w.gmail]])])])])]),(0,a._)("button",{class:"button is-link",disabled:!w.authorized,onClick:i[18]||(i[18]=(...s)=>v.updateInfo&&v.updateInfo(...s))},"Confirm",8,Us),w.updateInfoSuccess?((0,a.wg)(),(0,a.iD)("div",Zs,"Changes have been updated successfully.")):(0,a.kq)("",!0)])])])])])])])}var Ns=e(6154),zs=e(8618),Ls={name:"DoctorSecurity",components:{DoctorMenu:zs.Z,ForgotPassword:(0,a.RC)((()=>e.e(726).then(e.bind(e,1726))))},async mounted(){await Ns.Z.get("/session/doctor").then((s=>this.doctorDetails=s.data)),this.verified=await this.doctorDetails.verified,this.id=await this.doctorDetails._id,this.licenseNo=await this.doctorDetails.licenseNo,this.fullname=await this.doctorDetails.fullname,this.gmail=await this.doctorDetails.gmail},data(){return{doctorDetails:[],OTP:null,id:null,isActiveModal:!1,currentPassword:null,currentPasswordValidate:null,currentPasswordValidateMessage:null,currentValidateMessage:null,passwordValidateMessage:null,incorrectPasswordValidate:null,passwordValidate:null,password:null,passwordRepeat:null,passwordSuccess:!1,verified:null,licenseNo:null,fullname:null,gmail:null,authorized:!1,verifyEmailSent:!1,emailTaken:!1,codeError:!1,updateInfoSuccess:!1,incorrectCode:!1,errMsg:"",verifyButtonLoading:!1}},methods:{async updatePassword(){if(""!==await this.currentPassword&&""!==this.password&&""!==this.passwordRepeat)if(this.password!==this.passwordRepeat)this.passwordValidate=!0,this.passwordValidateMessage="Passwords do not match",this.passwordSuccess=!1;else try{await Ns.Z.put("/api/updatePassword/doctor",{doctorID:this.id,currentPassword:this.currentPassword,newPassword:this.password}).then((s=>{s.data?(this.incorrectPasswordValidate=!1,this.passwordValidate=!1,this.passwordSuccess=!0,this.currentPassword=null,this.password=null,this.passwordRepeat=null):(this.passwordValidate=!1,this.passwordSuccess=!1,this.incorrectPasswordValidate=!0,this.currentPasswordValidateMessage="Incorrect current password")}))}catch(s){this.passwordValidate=!1,this.passwordSuccess=!1,this.incorrectPasswordValidate=!0,this.errMsg=s}},showPass(){let s=document.getElementsByClassName("password");for(let i=0;i<s.length;i++)"password"===s[i].type?s[i].type="text":s[i].type="password"},async modalUpEditInfo(){this.codeError=!1,await Ns.Z.post("/api/code/email",{email:this.gmail}).then((async s=>{s.data?(this.isActiveModal=!0,this.codeError=!0):await Ns.Z.post("/api/OTPMail",{email:this.gmail}).then(this.isActiveModal=!0).catch((s=>{s&&(this.codeError=!0)}))}))},async modalUpInfoVerify(){this.isActiveModal=!0},async sendVerificationEmail(){this.verifyButtonLoading=!0;let s=[];this.verifyEmailSent=!1,this.codeError=!1,this.emailTaken=!1,await Ns.Z.get("/api/doctor").then((i=>s=i.data.find((s=>s.gmail===this.gmail)))),"undefined"!==typeof s?await Ns.Z.post("/api/code/email",{email:this.gmail}).then((async s=>{s.data?(this.verifyEmailSent=!0,this.codeError=!0):(await Ns.Z.post("/api/OTPMail",{email:this.gmail}).catch((s=>{s&&(this.codeError=!0)})),this.verifyEmailSent=!0)})):(this.verifyEmailSent=!0,this.codeError=!0,this.emailTaken=!0),this.verifyButtonLoading=!1},async confirmOTPEditInfo(){this.verifyButtonLoading=!0,this.incorrectCode=!1,await Ns.Z.post("/api/code/verify",{code:this.OTP}).then((s=>{s.data?this.codeError||(this.authorized=!0,this.isActiveModal=!1):this.incorrectCode=!0})),this.verifyButtonLoading=!1},async verifyEmail(){this.verifyButtonLoading=!0,this.incorrectCode=!1,await Ns.Z.post("/api/code/verify",{code:this.OTP}).then((async s=>{await s.data?this.codeError?this.incorrectCode=!0:(await Ns.Z.put(`/api/doctor/${this.id}`,{gmail:this.gmail,verified:!0}),await Ns.Z.put("/session/doctor",{gmail:this.gmail,verified:!0}),this.verified=!0,this.isActiveModal=!1,this.isActiveModal||await Ns.Z.get("/session/doctor").then((s=>this.doctorDetails=s.data))):this.incorrectCode=!0})),this.verifyButtonLoading=!1},async updateInfo(){this.updateInfoSuccess=!1,this.verified&&(await Ns.Z.put(`/api/doctor/${this.id}`,{licenseNo:this.licenseNo,name:this.fullname}),await Ns.Z.put("/session/doctor",{licenseNo:this.licenseNo,name:this.fullname}),await Ns.Z.get("/session/doctor").then((s=>this.fullname=s.data.fullname)),this.updateInfoSuccess=!0)},closeModal(){this.isActiveModal=!1}}},Rs=e(3744);const Bs=(0,Rs.Z)(Ls,[["render",Os],["__scopeId","data-v-77f6730b"]]);var Hs=Bs}}]);
//# sourceMappingURL=503.d7c7ceaa.js.map