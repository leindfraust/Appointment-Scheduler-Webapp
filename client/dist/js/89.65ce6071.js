"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[89],{7787:function(t,e,a){a.d(e,{Z:function(){return c}});var s=a(6252),i=a(2262),n=a(3577);const l={key:0,class:"notification is-danger"};var o={__name:"CatchError",props:{errMsg:null},setup(t){const e=t,a=(0,s.Fl)((()=>e.errMsg));return(t,e)=>{const o=(0,s.up)("router-link");return(0,i.SU)(a)?((0,s.wg)(),(0,s.iD)("div",l,[(0,s.Uk)("Sorry, something went wrong. "+(0,n.zw)((0,i.SU)(a).message)+", please try again later or ",1),(0,s.Wm)(o,{to:"/contactus"},{default:(0,s.w5)((()=>[(0,s.Uk)("contact us")])),_:1}),(0,s.Uk)(". ")])):(0,s.kq)("",!0)}}};const d=o;var c=d},8618:function(t,e,a){a.d(e,{Z:function(){return M}});var s=a(6252),i=a(3577);const n=t=>((0,s.dD)("data-v-1bc7b8b5"),t=t(),(0,s.Cn)(),t),l={class:"navbar is-hidden-desktop"},o={class:"navbar-brand"},d={class:"navbar-item"},c={class:"label"},r=n((()=>(0,s._)("span",{"aria-hidden":"true"},null,-1))),p=n((()=>(0,s._)("span",{"aria-hidden":"true"},null,-1))),u=n((()=>(0,s._)("span",{"aria-hidden":"true"},null,-1))),m=[r,p,u],h={class:"has-text-centered block",style:{padding:"5px"}},g={class:"is-hidden-mobile is-hidden-touch image image-outer is-square",style:{margin:"auto"}},y=["src"],_={key:0,class:"title is-6"},b={class:"menu-list block"},v=n((()=>(0,s._)("p",{class:"menu-label"},"General",-1))),C=n((()=>(0,s._)("p",{class:"menu-label"},"Verification and Information",-1))),w=n((()=>(0,s._)("p",{class:"menu-label"},"Support",-1))),k={class:"block has-text-centered"};function S(t,e,a,n,r,p){return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("nav",l,[(0,s._)("div",o,[(0,s._)("a",d,[(0,s._)("label",c,"Dr. "+(0,i.zw)(t.$store.state.doctorName),1)]),(0,s._)("a",{role:"button",class:(0,i.C_)(["navbar-burger",{"is-active":!r.isActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbar",onClick:e[0]||(e[0]=(...t)=>p.menuNav&&p.menuNav(...t))},m,2)])]),(0,s._)("aside",{class:(0,i.C_)(["menu box",{"is-hidden-mobile":r.isActive,fixedMenu:r.isActive}]),style:{"background-color":"#D8E5FF",padding:"20px"}},[(0,s._)("div",h,[(0,s._)("figure",g,[(0,s._)("img",{class:"is-rounded image-inner",src:`http://res.cloudinary.com/leindfraust/image/upload/v${(new Date).getMonth()}${(new Date).getDate()}/assets/doctors/${r.alias}.jpg`},null,8,y)]),r.isActive?((0,s.wg)(),(0,s.iD)("h5",_,"Dr. "+(0,i.zw)(t.$store.state.doctorName),1)):(0,s.kq)("",!0)]),(0,s._)("ul",b,[v,(0,s._)("li",null,[(0,s._)("a",{onClick:e[1]||(e[1]=(...t)=>p.routeHome&&p.routeHome(...t))},"Appointments")]),(0,s._)("li",null,[(0,s._)("a",{onClick:e[2]||(e[2]=(...t)=>p.openPatientHistory&&p.openPatientHistory(...t))},"Appointment History")]),(0,s._)("li",null,[(0,s._)("a",{onClick:e[3]||(e[3]=(...t)=>p.openPatientAppointmentsCancelled&&p.openPatientAppointmentsCancelled(...t))},"Cancelled Appointments")]),(0,s._)("li",null,[(0,s._)("a",{onClick:e[4]||(e[4]=(...t)=>p.openSchedule&&p.openSchedule(...t))},"Schedule")]),C,(0,s._)("li",null,[(0,s._)("a",{onClick:e[5]||(e[5]=(...t)=>p.openProfile&&p.openProfile(...t))},"Profile")]),(0,s._)("li",null,[(0,s._)("a",{onClick:e[6]||(e[6]=(...t)=>p.openSecurity&&p.openSecurity(...t))},"Security")]),(0,s._)("li",null,[(0,s._)("a",{onClick:e[7]||(e[7]=(...t)=>p.openPayment&&p.openPayment(...t))},"Payment")]),w,(0,s._)("li",null,[(0,s._)("a",{onClick:e[8]||(e[8]=t=>this.$router.push("/contactus"))},"Contact Us")])]),(0,s._)("div",k,[(0,s._)("button",{onClick:e[9]||(e[9]=(...t)=>p.logout&&p.logout(...t)),class:"button is-link is-rounded",type:"button"},"Logout")])],2)],64)}var f=a(4239),D=a(8945),A={name:"AdminMenu",data(){return{alias:f.Z.state.alias,isActive:!0}},methods:{async logout(){f.Z.commit("alias",null),await D.Z["delete"]("/session/doctor"),await this.$router.push("/account/login")},async routeHome(){await this.$router.push(`/doctor/${this.alias}/appointments`)},async openProfile(){await this.$router.push(`/doctor/${this.alias}/profile`)},async openPatientHistory(){await this.$router.push(`/doctor/${this.alias}/appointments/history`)},async openPatientAppointmentsCancelled(){await this.$router.push(`/doctor/${this.alias}/appointments/cancelled`)},async openSecurity(){await this.$router.push(`/doctor/${this.alias}/security`)},async openSchedule(){await this.$router.push(`/doctor/${this.alias}/schedule`)},async openPayment(){await this.$router.push(`/doctor/${this.alias}/payment`)},menuNav(){this.isActive=!this.isActive}}},x=a(3744);const $=(0,x.Z)(A,[["render",S],["__scopeId","data-v-1bc7b8b5"]]);var M=$},9089:function(t,e,a){a.r(e),a.d(e,{default:function(){return Vt}});var s=a(6252),i=a(3577),n=a(9963);const l={class:"main-doctor"},o={class:"columns"},d={class:"column is-2"},c={class:"column"},r={class:"section"},p=(0,s._)("h1",{class:"title"},"SET SCHEDULES",-1),u=(0,s._)("div",{class:"modal-background"},null,-1),m={class:"modal-content"},h={class:"card"},g={class:"card-content"},y={class:"content has-text-centered"},_={class:"control block"},b=(0,s._)("label",{class:"label"},"Prefix(OPTIONAL):",-1),v={class:"select block"},C=["value"],w=(0,s._)("label",{class:"label"},"Time start:",-1),k=(0,s._)("br",null,null,-1),S=(0,s._)("label",{class:"label"},"Time end:",-1),f={class:"control block"},D=(0,s._)("label",{class:"label"},"Appointment limit:",-1),A={class:"columns",style:{margin:"auto"}},x={class:"column"},$=(0,s._)("p",{class:"label"}," Appointment Categories(select all that applies) ",-1),M={class:"panel"},Z={style:{"max-height":"20em",overflow:"auto"}},E=["value"],z=["onClick"],H=["onClick"],L={class:"panel-block"},P={class:"has-text-centered"},U={class:"field has-addons"},I={class:"control"},V={class:"control"},O=["disabled"],T={class:"column"},N=(0,s._)("label",{class:"label"},"Selected",-1),q={class:"columns is-multiline"},W={class:"column",id:"selectedSpecializations"},K=["onClick"],Y=(0,s._)("br",null,null,-1),F={class:"field"},j=(0,s._)("div",{class:"block"},null,-1),G={class:"field"},R=(0,s._)("label",{class:"label"},"Payment Amount: ",-1),X={class:"control"},B=(0,s._)("p",{class:"help"},[(0,s.Uk)("Make sure you have successfully "),(0,s._)("b",null,"activated your account"),(0,s.Uk)(" and had already setup your "),(0,s._)("b",null,"Payment methods"),(0,s.Uk)(" under "),(0,s._)("b",null,"Verification and Information"),(0,s.Uk)(". Failing to setup your payment methods might delay your payout every week. ")],-1),J=(0,s._)("br",null,null,-1),Q={class:"block"},tt=["disabled"],et=(0,s._)("div",{class:"modal-background"},null,-1),at=(0,s._)("div",{class:"modal-content loader"},null,-1),st=[et,at],it={class:"columns"},nt={class:"column"},lt={key:0,class:"notification is-success has-text-centered"},ot={class:"column"},dt={class:"container"},ct=(0,s._)("h1",{class:"subtitle has-text-weight-bold"},"Ongoing Schedules:",-1),rt={key:0,class:"columns is-multiline is-vcentered",style:{overflow:"scroll","max-height":"30em"}},pt={class:"block card"},ut={class:"card-content"},mt={class:"buttons is-right"},ht=["onClick"],gt=(0,s._)("i",{class:"fa-solid fa-pen-to-square"},null,-1),yt=[gt],_t=["onClick"],bt=(0,s._)("i",{class:"fa-solid fa-trash-can"},null,-1),vt=[bt],Ct={class:"content"},wt={class:"title is-5 has-text-black has-text-left"},kt={class:"has-text-black"},St={class:"has-text-black"},ft={class:"has-text-black"},Dt={class:"has-text-black"},At={class:"has-text-black"},xt={key:1,class:"notification is-warning"},$t=(0,s._)("h1",{class:"title is-5"},"No ongoing schedules.",-1),Mt=[$t];function Zt(t,e,a,et,at,gt){const bt=(0,s.up)("DoctorMenu"),$t=(0,s.up)("CatchError"),Zt=(0,s.up)("v-date-picker"),Et=(0,s.up)("v-calendar");return(0,s.wg)(),(0,s.iD)("div",l,[(0,s._)("div",o,[(0,s._)("div",d,[(0,s.Wm)(bt)]),(0,s._)("div",c,[(0,s._)("section",r,[(0,s.Wm)($t,{"err-msg":at.errMsg},null,8,["err-msg"]),p,(0,s._)("div",{class:(0,i.C_)(["modal",{"is-active":at.toggleModalSchedule}])},[u,(0,s._)("div",m,[(0,s._)("div",h,[(0,s._)("div",g,[(0,s._)("div",y,[(0,s._)("div",_,[b,(0,s.wy)((0,s._)("input",{class:"input",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>at.prefix=t),style:{width:"33%"},placeholder:"e.g. ROOM305"},null,512),[[n.nr,at.prefix]])]),(0,s._)("div",v,[(0,s.wy)((0,s._)("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>at.selectedHospital=t)},[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(at.hospitalList,(t=>((0,s.wg)(),(0,s.iD)("option",{key:t,value:t.hospital},(0,i.zw)(t.hospital),9,C)))),128))],512),[[n.bM,at.selectedHospital]])]),w,(0,s.Wm)(Zt,{modelValue:at.timeStart,"onUpdate:modelValue":e[2]||(e[2]=t=>at.timeStart=t),mode:"time",timezone:at.timezone,class:"block"},null,8,["modelValue","timezone"]),k,S,(0,s.Wm)(Zt,{modelValue:at.timeEnd,"onUpdate:modelValue":e[3]||(e[3]=t=>at.timeEnd=t),mode:"time",timezone:at.timezone,class:"block"},null,8,["modelValue","timezone"]),(0,s._)("div",f,[D,(0,s.wy)((0,s._)("input",{class:"input",type:"number","onUpdate:modelValue":e[4]||(e[4]=t=>at.appointmentLimits=t),style:{width:"33%"}},null,512),[[n.nr,at.appointmentLimits]])]),(0,s._)("div",A,[(0,s._)("div",x,[$,(0,s._)("nav",M,[(0,s._)("div",Z,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(at.appointmentCategories,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{class:"panel-block",key:e,value:t},[(0,s._)("a",{onClick:e=>gt.selectAppointmentCategory(t)},(0,i.zw)(t)+"  ",9,z),"Consultation"!=t?((0,s.wg)(),(0,s.iD)("a",{key:0,class:"has-text-danger",onClick:e=>gt.deleteAppointmentCategory(t)},"DELETE",8,H)):(0,s.kq)("",!0)],8,E)))),128)),(0,s._)("div",L,[(0,s._)("div",P,[(0,s._)("div",U,[(0,s._)("div",I,[(0,s.wy)((0,s._)("input",{class:"input",type:"text","onUpdate:modelValue":e[5]||(e[5]=t=>at.appointmentCategory=t)},null,512),[[n.nr,at.appointmentCategory]])]),(0,s._)("div",V,[(0,s._)("button",{class:"button is-info",onClick:e[6]||(e[6]=(...t)=>gt.addAppointmentCategory&&gt.addAppointmentCategory(...t)),disabled:""==at.appointmentCategory},"Add",8,O)])])])])])])]),(0,s._)("div",T,[N,(0,s._)("div",q,[(0,s._)("div",W,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(at.selectedAppointmentCategories,((t,e)=>((0,s.wg)(),(0,s.iD)("button",{key:e,class:"button is-light",style:{margin:"5px"}},[(0,s.Uk)((0,i.zw)(t)+"  ",1),(0,s._)("span",{class:"has-text-danger",onClick:e=>gt.undoAppointmentCategory(t)},"X",8,K)])))),128))])])])]),Y,(0,s._)("div",F,[j,(0,s._)("div",G,[R,(0,s._)("div",X,[(0,s.wy)((0,s._)("input",{type:"number",class:"input",placeholder:"amount","onUpdate:modelValue":e[7]||(e[7]=t=>at.paymentAmount=t),style:{width:"33%"}},null,512),[[n.nr,at.paymentAmount]])])]),B]),J,(0,s._)("div",Q,[(0,s._)("button",{class:(0,i.C_)(["button",{"is-primary":!at.updateSchedule,"is-info":at.updateSchedule}]),type:"button",onClick:e[8]||(e[8]=(...t)=>gt.uploadSched&&gt.uploadSched(...t)),disabled:0==at.selectedAppointmentCategories.length||!at.paymentAmount},(0,i.zw)(at.updateSchedule?"Update Schedule":"Add Schedule"),11,tt)])])])])]),(0,s._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[9]||(e[9]=(...t)=>gt.modalClose&&gt.modalClose(...t))})],2),(0,s._)("div",{class:(0,i.C_)(["modal",{"is-active":at.loading}])},st,2),(0,s._)("div",it,[(0,s._)("div",nt,[at.uploadSchedSuccess?((0,s.wg)(),(0,s.iD)("div",lt,"Schedules Added/Updated! ")):(0,s.kq)("",!0),(0,s.Wm)(Et,{columns:t.$screens({default:1,lg:2}),rows:t.$screens({default:1,lg:2}),"is-expanded":t.$screens({default:!0,lg:!1}),modelValue:at.date,"onUpdate:modelValue":e[10]||(e[10]=t=>at.date=t),"min-date":new Date,"disabled-dates":[{start:new Date,end:new Date}],attributes:gt.attributes,onDayclick:gt.modalSchedPrompt,timezone:at.timezone},null,8,["columns","rows","is-expanded","modelValue","min-date","disabled-dates","attributes","onDayclick","timezone"])]),(0,s._)("div",ot,[(0,s._)("div",dt,[ct,0!==Object.keys(gt.daysIndexed).length?((0,s.wg)(),(0,s.iD)("div",rt,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(gt.daysIndexed,(t=>((0,s.wg)(),(0,s.iD)("div",{class:"column is-6",key:t.id},[(0,s._)("div",pt,[(0,s._)("div",ut,[(0,s._)("div",mt,[(0,s._)("button",{class:"button",onClick:e=>gt.modalSchedEdit(t)},yt,8,ht),(0,s._)("button",{class:"button",onClick:e=>gt.modalSchedDelete(t.dayDetail)},vt,8,_t)]),(0,s._)("div",Ct,[(0,s._)("p",wt,(0,i.zw)(new Date(t.date).toDateString()),1),(0,s._)("p",kt,"Prefix: "+(0,i.zw)(t.prefix),1),(0,s._)("p",St,"Hospital: "+(0,i.zw)(t.hospital),1),(0,s._)("p",ft,(0,i.zw)(t.timeStart)+" - "+(0,i.zw)(t.timeEnd),1),(0,s._)("p",Dt,"Appointment limit: "+(0,i.zw)(t.appointmentLimit),1),(0,s._)("p",At,"Payment Amount: "+(0,i.zw)(t.paymentAmount),1)])])])])))),128))])):((0,s.wg)(),(0,s.iD)("div",xt,Mt))])])])])])])])}var Et=a(8945),zt=a(4239),Ht=a(8618),Lt=a(7787),Pt={name:"SchedulerPage",components:{DoctorMenu:Ht.Z,CatchError:Lt.Z},data(){return{errMsg:"",alias:zt.Z.state.alias,profileImg:zt.Z.state.profileImg,userID:"",date:new Date,timeStart:"",timeEnd:"",timezone:"Asia/Hong_Kong",prefix:"",days:[],day:"",appointmentLimits:10,checkServer:null,toggleModalSchedule:!1,uploadSchedSuccess:!1,loading:!1,hospitalList:[],selectedHospital:"",updateSchedule:!1,appointmentCategory:"",appointmentCategories:[],selectedAppointmentCategories:[],paymentAmount:500}},async mounted(){await Et.Z.get("/session/doctor").then((t=>this.days=t.data.schedule)),await Et.Z.get("/session/doctor").then((t=>this.appointmentCategories=t.data.appointmentCategories)),await Et.Z.get("/session/doctor").then((t=>this.userID=t.data._id)),await Et.Z.get("/session/doctor").then((t=>this.hospitalList=t.data.hospitalOrigin)),this.selectedHospital=await this.hospitalList[0].hospital},computed:{attributes(){return this.days.map((t=>({highlight:!0,dates:new Date(t.date).toDateString(),popover:{label:`${t.hospital}, ${t.timeStart} - ${t.timeEnd}`}})))},daysIndexed(){return""!==this.days&&this.sortDate()}},methods:{sortDate(){return this.days.filter((t=>new Date(t.id)>new Date)).sort(((t,e)=>new Date(t.date).valueOf()-new Date(e.date).valueOf()))},timeStringConvert(t,e){return e.setHours(t.substr(0,t.indexOf(":"))),e.setMinutes(t.substr(3,t.indexOf(":"))),e.setSeconds(t.substr(6,t.indexOf(":"))),e},async uploadSched(){if(this.loading=!0,this.updateSchedule)try{await Et.Z.put(`/api/doctor/schedule_update/${this.userID}`,{schedule:{dayDetail:this.day,id:this.day.id,date:this.day.date,timeStart:this.timeStart.toLocaleTimeString(),timeEnd:this.timeEnd.toLocaleTimeString(),appointmentLimit:this.appointmentLimits,prefix:this.prefix,hospital:this.selectedHospital,appointmentCategories:this.selectedAppointmentCategories,paymentAmount:this.paymentAmount}}).then((async t=>{await Et.Z.put("/session/doctor",{schedule:t.data.schedule}),this.days=[...t.data.schedule]}))}catch(t){this.errMsg=t}else{this.days.push({dayDetail:this.day,id:this.day.id,date:this.day.date,timeStart:this.timeStart.toLocaleTimeString(),timeEnd:this.timeEnd.toLocaleTimeString(),appointmentLimit:this.appointmentLimits,prefix:this.prefix,hospital:this.selectedHospital,appointmentCategories:this.selectedAppointmentCategories,paymentAmount:this.paymentAmount});try{await Et.Z.put(`/api/doctor/${this.userID}`,{schedule:this.days}),await Et.Z.put("/session/doctor",{schedule:this.days}).then((()=>{setTimeout((async()=>{await Et.Z.get("/session/doctor").then((t=>this.days=[...t.data.schedule]))}),500)}))}catch(t){this.errMsg=t}}this.toggleModalSchedule=!1,this.updateSchedule=!1,this.uploadSchedSuccess=!0,this.loading=!1},async modalSchedDelete(t){if(!t?.isDisabled){this.toggleModalSchedule=!0;const a=this.days.findIndex((e=>e.id===t.id));if(a>=0){this.loading=!0,this.days.splice(a,1),this.toggleModalSchedule=!1;try{await Et.Z.put(`/api/doctor/${this.userID}`,{schedule:this.days}),await Et.Z.put("/session/doctor",{schedule:this.days}).then((()=>{setTimeout((async()=>{await Et.Z.get("/session/doctor").then((t=>this.days=[...t.data.schedule]))}),500)}))}catch(e){this.errMsg=e}this.uploadSchedSuccess=!0,this.loading=!1}}},async modalSchedPrompt(t){if(t?.isDisabled||0!=t.attributes.length){const e=this.days.find((e=>e.id==t.id));this.modalSchedEdit(e)}else this.toggleModalSchedule=!0,this.day=t,this.timeStart=t.date,this.timeEnd=t.date},async modalSchedEdit(t){t.dayDetail?.isDisabled||(this.updateSchedule=!0,this.toggleModalSchedule=!0,this.prefix=t.prefix,this.day=t.dayDetail,this.timeStart=this.timeStringConvert(t.timeStart,new Date(t.dayDetail.date)),this.timeEnd=this.timeStringConvert(t.timeEnd,new Date(t.dayDetail.date)),this.appointmentLimits=t.appointmentLimit,this.selectedHospital=t.hospital,this.selectedAppointmentCategories=[...t.appointmentCategories],this.paymentAmount=t.paymentAmount)},modalClose(){this.toggleModalSchedule=!this.toggleModalSchedule,this.updateSchedule=!1,this.prefix="",this.day="",this.timeStart="",this.timeEnd="",this.appointmentLimits=10,this.selectedAppointmentCategories=[],this.appointmentCategory=""},async addAppointmentCategory(){this.appointmentCategories.find((t=>t===this.appointmentCategory))||this.appointmentCategories.push(this.appointmentCategory);try{await Et.Z.put(`/api/doctor/${this.userID}`,{appointmentCategories:this.appointmentCategories}),await Et.Z.put("/session/doctor",{appointmentCategories:this.appointmentCategories})}catch(t){this.errMsg=t}this.appointmentCategory=""},async deleteAppointmentCategory(t){this.appointmentCategories=this.appointmentCategories.filter((e=>e!==t));try{await Et.Z.put(`/api/doctor/${this.userID}`,{appointmentCategories:this.appointmentCategories}),await Et.Z.put("/session/doctor",{appointmentCategories:this.appointmentCategories}),this.undoAppointmentCategory(t)}catch(e){this.errMsg=e}},selectAppointmentCategory(t){this.selectedAppointmentCategories.find((e=>e===t))||this.selectedAppointmentCategories.push(t)},undoAppointmentCategory(t){this.selectedAppointmentCategories=this.selectedAppointmentCategories.filter((e=>e!==t))}}},Ut=a(3744);const It=(0,Ut.Z)(Pt,[["render",Zt]]);var Vt=It}}]);
//# sourceMappingURL=89.65ce6071.js.map