"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[222,726],{1726:function(a,e,l){l.r(e),l.d(e,{default:function(){return Q}});var s=l(6252),i=l(2262),t=l(3577),u=l(9963),n=l(6154);const o=a=>((0,s.dD)("data-v-572fa0ea"),a=a(),(0,s.Cn)(),a),v=o((()=>(0,s._)("div",{class:"modal-background"},null,-1))),c={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},d={key:0,class:"section box"},r=o((()=>(0,s._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),p={key:0,class:"notification is-danger"},w={key:1,class:"notification is-warning"},f={key:2,class:"container"},_={class:"field"},y={class:"control"},m=o((()=>(0,s._)("label",{class:"label"},"Enter Username",-1))),g={class:"field"},h={class:"control"},k=o((()=>(0,s._)("label",{class:"label"},"Enter Email",-1))),b={class:"field"},H={class:"control"},P=["disabled"],D={key:3,class:"notification is-danger"},C={key:1,class:"section box"},Z={key:0,class:"container"},U={key:0,class:"notification is-warning"},q={class:"field"},x={class:"control"},V=o((()=>(0,s._)("label",{class:"label"},"Enter code",-1))),I={key:1,class:"container"},N={key:0,class:"notification is-danger"},S={key:1,class:"container"},T={class:"field"},E={class:"control"},O=o((()=>(0,s._)("label",{class:"label"},"New Password:",-1))),F={class:"field"},Y={class:"control"},M=o((()=>(0,s._)("label",{class:"label"},"Confirm Password:",-1))),W={class:"field"},j={class:"control"},z=["disabled"],B={key:2,class:"container"},A=o((()=>(0,s._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),G=[A];var J={__name:"ForgotPassword",props:{username:String,email:String,forgotPasswordPromptCount:{type:Number,default:0}},setup(a){const e=a,l=(0,i.iH)(!1),o=(0,i.iH)(""),A=(0,i.iH)(!1),J=(0,i.iH)(!1),K=(0,i.iH)(""),L=(0,i.iH)(!1),Q=(0,i.iH)(!1),R=(0,i.iH)(!1),X=(0,i.iH)(""),$=(0,i.iH)(""),aa=(0,i.iH)(!1),ea=(0,i.iH)(!1),la=(0,i.iH)(!1),sa=(0,i.iH)(!1),ia=(0,i.iH)(""),ta=(0,i.iH)(e.username),ua=(0,i.iH)(e.email),na=(0,i.iH)(""),oa=(0,i.iH)(2),va=(0,s.Fl)((()=>e.forgotPasswordPromptCount));async function ca(){if(await n.Z.post("/api/user/verify_username",{username:ta.value,email:ua.value,forgotPassword:!0}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await n.Z.post("/api/OTPMail",{email:ua.value}).then(L.value=!0),L.value=!0,na.value="patient",sa.value=!1}catch(a){o.value=a}}else la.value=!0}async function da(){if(await n.Z.post("/api/doctor/verify_username",{username:ta.value,email:ua.value,forgotPassword:!0}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await n.Z.post("/api/OTPMail",{email:ua.value}).then(L.value=!0),L.value=!0,na.value="doctor",sa.value=!1}catch(a){o.value=a}}else la.value=!0}async function ra(){if(await n.Z.post("/api/manager/verify_username",{username:ta.value,email:ua.value,forgotPassword:!0}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await n.Z.post("/api/OTPMail",{email:ua.value}).then(L.value=!0),L.value=!0,na.value="provider",sa.value=!1}catch(a){o.value=a}}else la.value=!0}async function pa(){if(null!=ta.value||null!=ua.value){let a;if(l.value=!0,await n.Z.post("/api/code/email",{email:ua.value}).then((e=>a=e.data)),a)J.value=!0;else{J.value=!1,sa.value=!0;while(sa.value){if(await ca(),ia.value)break;if(await da(),ia.value)break;if(await ra(),ia.value)break;sa.value=!1}}l.value=!1}}async function wa(){let a;R.value=!1,Q.value=!1,await n.Z.post("/api/code/verify",{code:K.value}).then((e=>a=e.data)),a?Q.value=!0:R.value=!0}async function fa(){if(X.value===$.value){if("patient"==na.value)try{await n.Z.put("/api/fupdatePassword/patient",{patientID:ia.value,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,ia.value=""}else if("doctor"==na.value)try{await n.Z.put("/api/fupdatePassword/doctor",{doctorID:ia.value,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,ia.value=""}else if("provider"==na.value)try{await n.Z.put("/api/fupdatePassword/manager",{managerID:ia.value,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,ia.value=""}}else aa.value=!0}return(a,e)=>((0,s.wg)(),(0,s.iD)(s.HY,null,[(0,i.SU)(va)>=oa.value?((0,s.wg)(),(0,s.iD)("a",{key:0,class:"help has-text-danger",onClick:e[0]||(e[0]=a=>A.value=!A.value)},"Forgot Password")):(0,s.kq)("",!0),(0,s._)("div",{class:(0,t.C_)(["modal",{"is-active":A.value}])},[v,(0,s._)("div",c,[L.value?((0,s.wg)(),(0,s.iD)("section",C,[Q.value?((0,s.wg)(),(0,s.iD)("div",I,[aa.value?((0,s.wg)(),(0,s.iD)("div",N,"Passwords not match.")):(0,s.kq)("",!0),ea.value?((0,s.wg)(),(0,s.iD)("div",B,G)):((0,s.wg)(),(0,s.iD)("div",S,[(0,s._)("div",T,[(0,s._)("div",E,[O,(0,s.wy)((0,s._)("input",{class:"input",type:"password","onUpdate:modelValue":e[4]||(e[4]=a=>X.value=a)},null,512),[[u.nr,X.value]])])]),(0,s._)("div",F,[(0,s._)("div",Y,[M,(0,s.wy)((0,s._)("input",{class:"input",type:"password","onUpdate:modelValue":e[5]||(e[5]=a=>$.value=a)},null,512),[[u.nr,$.value]])])]),(0,s._)("div",W,[(0,s._)("div",j,[(0,s._)("button",{class:"button",onClick:fa,disabled:""==X.value&&""==$.value},"Confirm",8,z)])])]))])):((0,s.wg)(),(0,s.iD)("div",Z,[R.value?((0,s.wg)(),(0,s.iD)("div",U,"Incorrect code, please try again.")):(0,s.kq)("",!0),(0,s._)("div",q,[(0,s._)("div",x,[V,(0,s.wy)((0,s._)("input",{class:"input",type:"number","onUpdate:modelValue":e[3]||(e[3]=a=>K.value=a)},null,512),[[u.nr,K.value]])])]),(0,s._)("div",{class:"field"},[(0,s._)("div",{class:"control"},[(0,s._)("button",{class:"button",onClick:wa},"Verify")])])]))])):((0,s.wg)(),(0,s.iD)("section",d,[r,o.value?((0,s.wg)(),(0,s.iD)("div",p,(0,t.zw)(o.value),1)):(0,s.kq)("",!0),la.value?((0,s.wg)(),(0,s.iD)("div",w,"No account has been found linked with this email.")):(0,s.kq)("",!0),J.value?((0,s.wg)(),(0,s.iD)("div",D,"You have to wait 10 minutes before requesting a code again. ")):((0,s.wg)(),(0,s.iD)("div",f,[(0,s._)("div",_,[(0,s._)("div",y,[m,(0,s.wy)((0,s._)("input",{class:"input",type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>ta.value=a)},null,512),[[u.nr,ta.value]])])]),(0,s._)("div",g,[(0,s._)("div",h,[k,(0,s.wy)((0,s._)("input",{class:"input",type:"email","onUpdate:modelValue":e[2]||(e[2]=a=>ua.value=a)},null,512),[[u.nr,ua.value]])])]),(0,s._)("div",b,[(0,s._)("div",H,[(0,s._)("button",{class:(0,t.C_)(["button",{"is-loading":l.value}]),onClick:pa,disabled:null==ua.value||null==ta.value},"Send OTP",10,P)])])]))]))]),(0,s._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=a=>A.value=!1)})],2)],64))}},K=l(3744);const L=(0,K.Z)(J,[["__scopeId","data-v-572fa0ea"]]);var Q=L},9934:function(a,e,l){l.r(e),l.d(e,{default:function(){return S}});var s=l(6252),i=l(9963),t=l(5633),u=l(6154),n=l(2262),o=l(1726);const v=a=>((0,s.dD)("data-v-069ee4c1"),a=a(),(0,s.Cn)(),a),c={class:"hero is-info is-fullheight"},d={class:"hero-body"},r={class:"container"},p={class:"box"},w={key:0,class:"notification is-danger"},f={key:1,class:"notification is-success"},_={class:"field"},y={class:"control"},m=v((()=>(0,s._)("label",{class:"label"},"Current Password:",-1))),g={key:0,class:"help is-danger"},h={class:"field"},k={class:"control"},b=v((()=>(0,s._)("label",{class:"label"},"New Password:",-1))),H={key:0,class:"help is-danger"},P={class:"field"},D={class:"control"},C=v((()=>(0,s._)("label",{class:"label"},"Confirm Password:",-1))),Z={key:0,class:"help is-danger"},U={class:"field has-text-right"},q={class:"control"},x=["disabled"];var V={__name:"UserSecurity",setup(a){const e=(0,n.iH)([]),l=(0,n.iH)(""),v=(0,n.iH)(""),V=(0,n.iH)(""),I=(0,n.iH)(""),N=(0,n.iH)(!1),S=(0,n.iH)(!1),T=(0,n.iH)(!1),E=(0,n.iH)(""),O=(0,n.iH)("");function F(){let a=document.getElementsByClassName("password");for(let e=0;e<a.length;e++)"password"===a[e].type?a[e].type="text":a[e].type="password"}async function Y(){if(""!==l.value&&v.value,v.value!==V.value?S.value=!0:S.value=!1,!S.value)try{await u.Z.put("/api/updatePassword/patient",{patientID:e.value._id,currentPassword:l.value,newPassword:v.value}).then((a=>{a.data?(l.value="",v.value="",V.value="",N.value=!0,I.value=""):(N.value=!1,T.value=!0)}))}catch(a){I.value=a,N.value=!1}}return(0,s.bv)((async()=>{await u.Z.get("/session/patient").then((a=>e.value=a.data)),E.value=await e.value.username,O.value=await e.value.email})),(a,e)=>{const u=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(t.Z),(0,s._)("section",c,[(0,s._)("div",d,[(0,s._)("div",r,[(0,s._)("div",p,[I.value?((0,s.wg)(),(0,s.iD)("div",w,[(0,s.Uk)("Oops, something went wrong. Try again later or "),(0,s.Wm)(u,{to:"/contactus"},{default:(0,s.w5)((()=>[(0,s.Uk)("contact us")])),_:1})])):(0,s.kq)("",!0),N.value?((0,s.wg)(),(0,s.iD)("div",f,"Password changed successfully.")):(0,s.kq)("",!0),(0,s._)("div",_,[(0,s._)("div",y,[m,(0,s.wy)((0,s._)("input",{class:"input password is-rounded","onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a),type:"password",placeholder:"Current password"},null,512),[[i.nr,l.value]]),T.value?((0,s.wg)(),(0,s.iD)("p",g,"Current password is incorrect.")):(0,s.kq)("",!0)])]),(0,s._)("div",h,[(0,s._)("div",k,[b,(0,s.wy)((0,s._)("input",{class:"input password is-rounded","onUpdate:modelValue":e[1]||(e[1]=a=>v.value=a),type:"password",placeholder:"New password"},null,512),[[i.nr,v.value]])]),S.value?((0,s.wg)(),(0,s.iD)("p",H,"Password do not match.")):(0,s.kq)("",!0)]),(0,s._)("div",P,[(0,s._)("div",D,[C,(0,s.wy)((0,s._)("input",{class:"input password is-rounded","onUpdate:modelValue":e[2]||(e[2]=a=>V.value=a),type:"password",placeholder:"Confirm password"},null,512),[[i.nr,V.value]])]),S.value?((0,s.wg)(),(0,s.iD)("p",Z,"Password do not match.")):(0,s.kq)("",!0)]),(0,s._)("div",{class:"field"},[(0,s._)("div",{class:"control"},[(0,s._)("label",{class:"checkbox"},[(0,s._)("input",{type:"checkbox",onClick:F}),(0,s.Uk)(" Show password ")])])]),(0,s._)("div",U,[(0,s._)("div",q,[(0,s._)("button",{class:"button is-danger",onClick:Y,disabled:""===l.value||""===v.value||""===V.value},"Change password",8,x)])]),""!=E.value&&""!=O.value?((0,s.wg)(),(0,s.j4)(o["default"],{key:2,userType:"patient",username:E.value,email:O.value},null,8,["username","email"])):(0,s.kq)("",!0)])])])])],64)}}},I=l(3744);const N=(0,I.Z)(V,[["__scopeId","data-v-069ee4c1"]]);var S=N}}]);
//# sourceMappingURL=222.bdf5ef3c.js.map