"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[742],{7787:function(t,e,s){s.d(e,{Z:function(){return c}});var a=s(6252),i=s(2262),l=s(3577);const n={key:0,class:"notification is-danger"};var o={__name:"CatchError",props:{errMsg:null},setup(t){const e=t,s=(0,a.Fl)((()=>e.errMsg));return(t,e)=>{const o=(0,a.up)("router-link");return(0,i.SU)(s)?((0,a.wg)(),(0,a.iD)("div",n,[(0,a.Uk)("Sorry, something went wrong. "+(0,l.zw)((0,i.SU)(s).message)+", please try again later or ",1),(0,a.Wm)(o,{to:"/contactus"},{default:(0,a.w5)((()=>[(0,a.Uk)("contact us")])),_:1}),(0,a.Uk)(". ")])):(0,a.kq)("",!0)}}};const d=o;var c=d},9226:function(t,e,s){s.d(e,{Z:function(){return M}});var a=s(6252),i=s(3577);const l=t=>((0,a.dD)("data-v-45fdf8bd"),t=t(),(0,a.Cn)(),t),n={class:"navbar is-hidden-desktop"},o={class:"navbar-brand"},d={class:"navbar-item"},c={class:"label"},r=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),u=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),h=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),p=[r,u,h],m={class:"has-text-centered block",style:{padding:"5px"}},g={class:"is-hidden-mobile is-hidden-touch image image-outer is-square",style:{margin:"auto"}},_=["src"],y={key:0,class:"title is-6"},b={class:"menu-list block"},S=l((()=>(0,a._)("p",{class:"menu-label"},"General",-1))),v=l((()=>(0,a._)("p",{class:"menu-label"},"Verification and Information",-1))),w=l((()=>(0,a._)("p",{class:"menu-label"},"Support",-1))),f={class:"block has-text-centered"};function k(t,e,s,l,r,u){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("nav",n,[(0,a._)("div",o,[(0,a._)("a",d,[(0,a._)("label",c,"Dr. "+(0,i.zw)(t.$store.state.doctorName),1)]),(0,a._)("a",{role:"button",class:(0,i.C_)(["navbar-burger",{"is-active":!r.isActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbar",onClick:e[0]||(e[0]=(...t)=>u.menuNav&&u.menuNav(...t))},p,2)])]),(0,a._)("aside",{class:(0,i.C_)(["menu box",{"is-hidden-mobile":r.isActive,fixedMenu:r.isActive}]),style:{"background-color":"#D8E5FF",padding:"20px"}},[(0,a._)("div",m,[(0,a._)("figure",g,[(0,a._)("img",{class:"is-rounded image-inner",src:`http://res.cloudinary.com/leindfraust/image/upload/v${(new Date).getMonth()}${(new Date).getDate()}/assets/doctors/${r.alias}.jpg`},null,8,_)]),r.isActive?((0,a.wg)(),(0,a.iD)("h5",y,"Dr. "+(0,i.zw)(t.$store.state.doctorName),1)):(0,a.kq)("",!0)]),(0,a._)("ul",b,[S,(0,a._)("li",null,[(0,a._)("a",{onClick:e[1]||(e[1]=(...t)=>u.routeHome&&u.routeHome(...t))},"Appointments")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[2]||(e[2]=(...t)=>u.openPatientHistory&&u.openPatientHistory(...t))},"Appointment History")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[3]||(e[3]=(...t)=>u.openPatientAppointmentsCancelled&&u.openPatientAppointmentsCancelled(...t))},"Cancelled Appointments")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[4]||(e[4]=(...t)=>u.openSchedule&&u.openSchedule(...t))},"Schedule")]),v,(0,a._)("li",null,[(0,a._)("a",{onClick:e[5]||(e[5]=(...t)=>u.openProfile&&u.openProfile(...t))},"Profile")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[6]||(e[6]=(...t)=>u.openSecurity&&u.openSecurity(...t))},"Security")]),w,(0,a._)("li",null,[(0,a._)("a",{onClick:e[7]||(e[7]=(...e)=>t.openFAQs&&t.openFAQs(...e))},"FAQ")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[8]||(e[8]=t=>this.$router.push("/contactus"))},"Contact Us")])]),(0,a._)("div",f,[(0,a._)("button",{onClick:e[9]||(e[9]=(...t)=>u.logout&&u.logout(...t)),class:"button is-link is-rounded",type:"button"},"Logout")])],2)],64)}var D=s(4239),x=s(196),C={name:"AdminMenu",data(){return{alias:D.Z.state.alias,isActive:!0}},methods:{async logout(){D.Z.commit("alias",null),await x.ZP["delete"]("/session/doctor"),await this.$router.push("/doctor/login")},async routeHome(){await this.$router.push(`/doctor/${this.alias}/appointments`)},async openProfile(){await this.$router.push(`/doctor/${this.alias}/profile`)},async openPatientHistory(){await this.$router.push(`/doctor/${this.alias}/appointments/history`)},async openPatientAppointmentsCancelled(){await this.$router.push(`/doctor/${this.alias}/appointments/cancelled`)},async openSecurity(){await this.$router.push(`/doctor/${this.alias}/security`)},async openSchedule(){await this.$router.push(`/doctor/${this.alias}/schedule`)},menuNav(){this.isActive=!this.isActive}}},P=s(3744);const $=(0,P.Z)(C,[["render",k],["__scopeId","data-v-45fdf8bd"]]);var M=$},5742:function(t,e,s){s.r(e),s.d(e,{default:function(){return ct}});var a=s(6252),i=s(3577),l=s(9963);const n={class:"main-doctor"},o={class:"columns"},d={class:"column is-2"},c={class:"column"},r={class:"section"},u=(0,a._)("h1",{class:"title"},"SET SCHEDULES",-1),h=(0,a._)("div",{class:"modal-background"},null,-1),p={class:"modal-content"},m={class:"card"},g={class:"card-content"},_={class:"content has-text-centered"},y={class:"control block"},b=(0,a._)("label",{class:"label"},"Prefix(OPTIONAL):",-1),S={class:"select block"},v=["value"],w=(0,a._)("label",{class:"label"},"Time start:",-1),f=(0,a._)("br",null,null,-1),k=(0,a._)("label",{class:"label"},"Time end:",-1),D={class:"control block"},x=(0,a._)("label",{class:"label"},"Appointment limit:",-1),C={class:"block"},P=(0,a._)("div",{class:"modal-background"},null,-1),$=(0,a._)("div",{class:"modal-content loader"},null,-1),M=[P,$],A={class:"columns"},E={class:"column"},L={key:0,class:"notification is-success has-text-centered"},Z={class:"column"},z={class:"container"},H=(0,a._)("h1",{class:"subtitle has-text-weight-bold"},"Ongoing Schedules:",-1),U={key:0,class:"columns is-multiline",style:{overflow:"scroll","max-height":"30em"}},I={class:"block card"},V={class:"card-content"},O={class:"buttons is-right"},T=["onClick"],N=(0,a._)("i",{class:"fa-solid fa-pen-to-square"},null,-1),F=[N],W=["onClick"],q=(0,a._)("i",{class:"fa-solid fa-trash-can"},null,-1),K=[q],Q={class:"content"},Y={class:"title is-5 has-text-black has-text-left"},j={class:"has-text-black"},G={class:"has-text-black"},R={class:"has-text-black"},B={class:"has-text-black"},J={key:1,class:"notification is-warning"},X=(0,a._)("h1",{class:"title is-5"},"No ongoing schedules.",-1),tt=[X];function et(t,e,s,P,$,N){const q=(0,a.up)("DoctorMenu"),X=(0,a.up)("CatchError"),et=(0,a.up)("v-date-picker"),st=(0,a.up)("v-calendar");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",o,[(0,a._)("div",d,[(0,a.Wm)(q)]),(0,a._)("div",c,[(0,a._)("section",r,[(0,a.Wm)(X,{"err-msg":$.errMsg},null,8,["err-msg"]),u,(0,a._)("div",{class:(0,i.C_)(["modal",{"is-active":$.toggleModalSchedule}])},[h,(0,a._)("div",p,[(0,a._)("div",m,[(0,a._)("div",g,[(0,a._)("div",_,[(0,a._)("div",y,[b,(0,a.wy)((0,a._)("input",{class:"input",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>$.prefix=t),style:{width:"33%"},placeholder:"e.g. ROOM305"},null,512),[[l.nr,$.prefix]])]),(0,a._)("div",S,[(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>$.selectedHospital=t)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)($.hospitalList,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t,value:t.hospital},(0,i.zw)(t.hospital),9,v)))),128))],512),[[l.bM,$.selectedHospital]])]),w,(0,a.Wm)(et,{modelValue:$.timeStart,"onUpdate:modelValue":e[2]||(e[2]=t=>$.timeStart=t),mode:"time",timezone:$.timezone,class:"block"},null,8,["modelValue","timezone"]),f,k,(0,a.Wm)(et,{modelValue:$.timeEnd,"onUpdate:modelValue":e[3]||(e[3]=t=>$.timeEnd=t),mode:"time",timezone:$.timezone,class:"block"},null,8,["modelValue","timezone"]),(0,a._)("div",D,[x,(0,a.wy)((0,a._)("input",{class:"input",type:"number","onUpdate:modelValue":e[4]||(e[4]=t=>$.appointmentLimits=t),style:{width:"33%"}},null,512),[[l.nr,$.appointmentLimits]])]),(0,a._)("div",C,[(0,a._)("button",{class:(0,i.C_)(["button",{"is-primary":!$.updateSchedule,"is-info":$.updateSchedule}]),type:"button",onClick:e[5]||(e[5]=(...t)=>N.uploadSched&&N.uploadSched(...t))},(0,i.zw)($.updateSchedule?"Update Schedule":"Add Schedule"),3)])])])])]),(0,a._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=(...t)=>N.modalClose&&N.modalClose(...t))})],2),(0,a._)("div",{class:(0,i.C_)(["modal",{"is-active":$.loading}])},M,2),(0,a._)("div",A,[(0,a._)("div",E,[$.uploadSchedSuccess?((0,a.wg)(),(0,a.iD)("div",L,"Schedules Added/Updated! ")):(0,a.kq)("",!0),(0,a.Wm)(st,{columns:t.$screens({default:1,lg:2}),rows:t.$screens({default:1,lg:2}),"is-expanded":t.$screens({default:!0,lg:!1}),modelValue:$.date,"onUpdate:modelValue":e[7]||(e[7]=t=>$.date=t),"min-date":new Date,"disabled-dates":[{start:new Date,end:new Date}],attributes:N.attributes,onDayclick:N.modalSchedPrompt,timezone:$.timezone},null,8,["columns","rows","is-expanded","modelValue","min-date","disabled-dates","attributes","onDayclick","timezone"])]),(0,a._)("div",Z,[(0,a._)("div",z,[H,0!==Object.keys(N.daysIndexed).length?((0,a.wg)(),(0,a.iD)("div",U,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(N.daysIndexed,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"column is-6",key:t.id},[(0,a._)("div",I,[(0,a._)("div",V,[(0,a._)("div",O,[(0,a._)("button",{class:"button",onClick:e=>N.modalSchedEdit(t)},F,8,T),(0,a._)("button",{class:"button",onClick:e=>N.modalSchedDelete(t.dayDetail)},K,8,W)]),(0,a._)("div",Q,[(0,a._)("p",Y,(0,i.zw)(new Date(t.date).toDateString()),1),(0,a._)("p",j,"Prefix: "+(0,i.zw)(t.prefix),1),(0,a._)("p",G,"Hospital: "+(0,i.zw)(t.hospital),1),(0,a._)("p",R,(0,i.zw)(t.timeStart)+" - "+(0,i.zw)(t.timeEnd),1),(0,a._)("p",B,"Appointment limit: "+(0,i.zw)(t.appointmentLimit),1)])])])])))),128))])):((0,a.wg)(),(0,a.iD)("div",J,tt))])])])])])])])}var st=s(196),at=s(4239),it=s(9226),lt=s(7787),nt={name:"SchedulerPage",components:{DoctorMenu:it.Z,CatchError:lt.Z},data(){return{errMsg:"",alias:at.Z.state.alias,profileImg:at.Z.state.profileImg,userID:"",date:new Date,timeStart:"",timeEnd:"",timezone:"Asia/Hong_Kong",prefix:"",days:[],day:"",appointmentLimits:10,checkServer:null,toggleModalSchedule:!1,uploadSchedSuccess:!1,loading:!1,hospitalList:[],selectedHospital:"",updateSchedule:!1}},async mounted(){await st.ZP.get("/session/doctor").then((t=>this.days=t.data.schedule)),await st.ZP.get("/session/doctor").then((t=>this.userID=t.data._id)),await st.ZP.get("/session/doctor").then((t=>this.hospitalList=t.data.hospitalOrigin)),this.selectedHospital=await this.hospitalList[0].hospital},computed:{attributes(){return this.days.map((t=>({highlight:!0,dates:new Date(t.date).toDateString(),popover:{label:`${t.hospital}, ${t.timeStart} - ${t.timeEnd}`}})))},daysIndexed(){return""!==this.days&&this.sortDate()}},methods:{sortDate(){return this.days.sort(((t,e)=>{new Date(t.id),new Date(e.id)})).filter((t=>new Date(t.id)>new Date))},timeStringConvert(t,e){return e.setHours(t.substr(0,t.indexOf(":"))),e.setMinutes(t.substr(3,t.indexOf(":"))),e.setSeconds(t.substr(6,t.indexOf(":"))),e},async uploadSched(){if(this.loading=!0,this.updateSchedule)try{await st.ZP.put(`/api/doctor/schedule_update/${this.userID}`,{schedule:{dayDetail:this.day,id:this.day.id,date:this.day.date,timeStart:this.timeStart.toLocaleTimeString(),timeEnd:this.timeEnd.toLocaleTimeString(),appointmentLimit:this.appointmentLimits,prefix:this.prefix,hospital:this.selectedHospital}}).then((async t=>{await st.ZP.put("/session/doctor",{schedule:t.data.schedule}),this.days=await t.data.schedule}))}catch(t){this.errMsg=t}else{this.days.push({dayDetail:this.day,id:this.day.id,date:this.day.date,timeStart:this.timeStart.toLocaleTimeString(),timeEnd:this.timeEnd.toLocaleTimeString(),appointmentLimit:this.appointmentLimits,prefix:this.prefix,hospital:this.selectedHospital});try{await st.ZP.put(`/api/doctor/${this.userID}`,{schedule:this.days}),await st.ZP.put("/session/doctor",{schedule:this.days}).then((()=>{setTimeout((async()=>{await st.ZP.get("/session/doctor").then((t=>this.days=t.data.schedule))}),500)}))}catch(t){this.errMsg=t}}this.toggleModalSchedule=!1,this.updateSchedule=!1,this.uploadSchedSuccess=!0,this.loading=!1},async modalSchedDelete(t){if(!t?.isDisabled){this.toggleModalSchedule=!0;const s=this.days.findIndex((e=>e.id===t.id));if(s>=0){this.loading=!0,this.days.splice(s,1),this.toggleModalSchedule=!1;try{await st.ZP.put(`/api/doctor/${this.userID}`,{schedule:this.days}),await st.ZP.put("/session/doctor",{schedule:this.days}).then((()=>{setTimeout((async()=>{await st.ZP.get("/session/doctor").then((t=>this.days=t.data.schedule))}),500)}))}catch(e){this.errMsg=e}this.uploadSchedSuccess=!0,this.loading=!1}}},async modalSchedPrompt(t){if(t?.isDisabled||0!=t.attributes.length){const e=this.days.find((e=>e.id==t.id));this.modalSchedEdit(e)}else this.toggleModalSchedule=!0,this.day=t,this.timeStart=t.date,this.timeEnd=t.date},async modalSchedEdit(t){t.dayDetail?.isDisabled||(this.updateSchedule=!0,this.toggleModalSchedule=!0,this.prefix=t.prefix,this.day=t.dayDetail,this.timeStart=this.timeStringConvert(t.timeStart,new Date(t.dayDetail.date)),this.timeEnd=this.timeStringConvert(t.timeEnd,new Date(t.dayDetail.date)),this.appointmentLimits=t.appointmentLimit,this.selectedHospital=t.hospital)},modalClose(){this.toggleModalSchedule=!this.toggleModalSchedule,this.updateSchedule=!1,this.prefix="",this.day="",this.timeStart="",this.timeEnd="",this.appointmentLimits=10}}},ot=s(3744);const dt=(0,ot.Z)(nt,[["render",et]]);var ct=dt}}]);
//# sourceMappingURL=742.75b35b60.js.map