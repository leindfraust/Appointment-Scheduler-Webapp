"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[885],{9885:function(a,e,l){l.r(e),l.d(e,{default:function(){return R}});var s=l(6252),i=l(2262),t=l(3577),n=l(9963),u=l(9669),o=l.n(u);const c=a=>((0,s.dD)("data-v-c2f9401e"),a=a(),(0,s.Cn)(),a),d=c((()=>(0,s._)("div",{class:"modal-background"},null,-1))),v={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},r={key:0,class:"section box"},p=c((()=>(0,s._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),w={key:0,class:"notification is-danger"},f={key:1,class:"notification is-warning"},_={key:2,class:"container"},m={class:"field"},y={class:"control"},g=c((()=>(0,s._)("label",{class:"label"},"Enter Username",-1))),b={class:"field"},h={class:"control"},U=c((()=>(0,s._)("label",{class:"label"},"Enter Email",-1))),k={class:"field"},S={class:"control"},D=["disabled"],H={key:3,class:"notification is-danger"},P={key:1,class:"section box"},C={key:0,class:"container"},q={class:"field"},T={class:"control"},V=c((()=>(0,s._)("label",{class:"label"},"Enter code",-1))),x={key:1,class:"container"},E={key:0,class:"notification is-danger"},I={key:1,class:"container"},O={class:"field"},F={class:"control"},M=c((()=>(0,s._)("label",{class:"label"},"New Password:",-1))),Y={class:"field"},N={class:"control"},z=c((()=>(0,s._)("label",{class:"label"},"Confirm Password:",-1))),Z={class:"field"},j={class:"control"},A=["disabled"],B={key:2,class:"container"},G=c((()=>(0,s._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),J=[G];var K={__name:"ForgotPassword",props:{userType:String,username:String,email:String},setup(a){const e=a;let l=(0,i.iH)(!1),u=(0,i.iH)(""),c=(0,i.iH)(!1),G=(0,i.iH)(!1),K=(0,i.iH)(""),L=(0,i.iH)(!1),Q=(0,i.iH)(!1),R=(0,i.iH)(""),W=(0,i.iH)(""),X=(0,i.iH)(!1),$=(0,i.iH)(!1),aa=(0,i.iH)(!1),ea=(0,i.iH)(""),la=(0,i.iH)(e.username),sa=(0,i.iH)(e.email);async function ia(){if(null!=la.value||null!=sa.value){let s;if(l.value=!0,await o().post("/api/code/email",{email:sa.value}).then((a=>s=a.data)),s)G.value=!0;else if(G.value=!1,"patient"==e.userType)if(await o().post("/api/user/verify_username",{username:la.value,email:sa.value}).then((a=>ea.value=a.data)),ea.value){aa.value=!1;try{await o().post("/api/OTPMail",{email:sa.value}).then(L.value=!0),L.value=!0}catch(a){u.value=a}}else aa.value=!0;else if("doctor"==e.userType)if(await o().post("/api/doctor/verify_username",{username:la.value,email:sa.value}).then((a=>ea.value=a.data)),ea.value){aa.value=!1;try{await o().post("/api/OTPMail",{email:sa.value}).then(L.value=!0),L.value=!0}catch(a){u.value=a}}else aa.value=!0;else if("manager"==e.userType)if(await o().post("/api/manager/verify_username",{username:la.value,email:sa.value}).then((a=>ea.value=a.data)),ea.value){aa.value=!1;try{await o().post("/api/OTPMail",{email:sa.value}).then(L.value=!0),L.value=!0}catch(a){u.value=a}}else aa.value=!0;l.value=!1}}async function ta(){let a;Q.value=!1,await o().post("/api/code/verify",{code:K.value}).then((e=>a=e.data)),a&&(Q.value=!0)}async function na(){if(R.value===W.value){if("patient"==e.userType)try{await o().put("/api/fupdatePassword/patient",{patientID:ea.value._id,password:R.value}),ea.value="",$.value=!0}catch(a){$.value=!1,u.value=a,ea.value=""}else if("doctor"==e.userType)try{await o().put("/api/fupdatePassword/doctor",{doctorID:ea.value._id,password:R.value}),ea.value="",$.value=!0}catch(a){$.value=!1,u.value=a,ea.value=""}else if("manager"==e.userType)try{await o().put("/api/fupdatePassword/manager",{managerID:ea.value._id,password:R.value}),ea.value="",$.value=!0}catch(a){$.value=!1,u.value=a,ea.value=""}}else X.value=!0}return(a,e)=>((0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("a",{class:"subtitle has-text-danger",onClick:e[0]||(e[0]=a=>(0,i.dq)(c)?c.value=!(0,i.SU)(c):c=!(0,i.SU)(c))},"Forgot Password"),(0,s._)("div",{class:(0,t.C_)(["modal",{"is-active":(0,i.SU)(c)}])},[d,(0,s._)("div",v,[(0,i.SU)(L)?((0,s.wg)(),(0,s.iD)("section",P,[(0,i.SU)(Q)?((0,s.wg)(),(0,s.iD)("div",x,[(0,i.SU)(X)?((0,s.wg)(),(0,s.iD)("div",E,"Passwords not match.")):(0,s.kq)("",!0),(0,i.SU)($)?((0,s.wg)(),(0,s.iD)("div",B,J)):((0,s.wg)(),(0,s.iD)("div",I,[(0,s._)("div",O,[(0,s._)("div",F,[M,(0,s.wy)((0,s._)("input",{class:"input",type:"password","onUpdate:modelValue":e[4]||(e[4]=a=>(0,i.dq)(R)?R.value=a:R=a)},null,512),[[n.nr,(0,i.SU)(R)]])])]),(0,s._)("div",Y,[(0,s._)("div",N,[z,(0,s.wy)((0,s._)("input",{class:"input",type:"password","onUpdate:modelValue":e[5]||(e[5]=a=>(0,i.dq)(W)?W.value=a:W=a)},null,512),[[n.nr,(0,i.SU)(W)]])])]),(0,s._)("div",Z,[(0,s._)("div",j,[(0,s._)("button",{class:"button",onClick:na,disabled:""==(0,i.SU)(R)&&""==(0,i.SU)(W)},"Confirm",8,A)])])]))])):((0,s.wg)(),(0,s.iD)("div",C,[(0,s._)("div",q,[(0,s._)("div",T,[V,(0,s.wy)((0,s._)("input",{class:"input",type:"number","onUpdate:modelValue":e[3]||(e[3]=a=>(0,i.dq)(K)?K.value=a:K=a)},null,512),[[n.nr,(0,i.SU)(K)]])])]),(0,s._)("div",{class:"field"},[(0,s._)("div",{class:"control"},[(0,s._)("button",{class:"button",onClick:ta},"Verify")])])]))])):((0,s.wg)(),(0,s.iD)("section",r,[p,(0,i.SU)(u)?((0,s.wg)(),(0,s.iD)("div",w,(0,t.zw)((0,i.SU)(u)),1)):(0,s.kq)("",!0),(0,i.SU)(aa)?((0,s.wg)(),(0,s.iD)("div",f,"No account has been found linked with this email.")):(0,s.kq)("",!0),(0,i.SU)(G)?((0,s.wg)(),(0,s.iD)("div",H,"You have to wait 10 minutes before requesting a code again. ")):((0,s.wg)(),(0,s.iD)("div",_,[(0,s._)("div",m,[(0,s._)("div",y,[g,(0,s.wy)((0,s._)("input",{class:"input",type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>(0,i.dq)(la)?la.value=a:la=a)},null,512),[[n.nr,(0,i.SU)(la)]])])]),(0,s._)("div",b,[(0,s._)("div",h,[U,(0,s.wy)((0,s._)("input",{class:"input",type:"email","onUpdate:modelValue":e[2]||(e[2]=a=>(0,i.dq)(sa)?sa.value=a:sa=a)},null,512),[[n.nr,(0,i.SU)(sa)]])])]),(0,s._)("div",k,[(0,s._)("div",S,[(0,s._)("button",{class:(0,t.C_)(["button",{"is-loading":(0,i.SU)(l)}]),onClick:ia,disabled:null==(0,i.SU)(sa)||null==(0,i.SU)(la)},"Send OTP",10,D)])])]))]))]),(0,s._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=a=>(0,i.dq)(c)?c.value=!1:c=!1)})],2)],64))}},L=l(3744);const Q=(0,L.Z)(K,[["__scopeId","data-v-c2f9401e"]]);var R=Q}}]);
//# sourceMappingURL=885.52893d9f.js.map