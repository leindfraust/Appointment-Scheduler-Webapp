"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[479,885],{9885:function(a,e,s){s.r(e),s.d(e,{default:function(){return J}});var t=s(6252),l=s(2262),i=s(3577),n=s(9963),o=s(9669),r=s.n(o);const u=a=>((0,t.dD)("data-v-c2f9401e"),a=a(),(0,t.Cn)(),a),c=u((()=>(0,t._)("div",{class:"modal-background"},null,-1))),d={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},v={key:0,class:"section box"},p=u((()=>(0,t._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),g={key:0,class:"notification is-danger"},m={key:1,class:"notification is-warning"},w={key:2,class:"container"},h={class:"field"},_={class:"control"},y=u((()=>(0,t._)("label",{class:"label"},"Enter Username",-1))),f={class:"field"},b={class:"control"},k=u((()=>(0,t._)("label",{class:"label"},"Enter Email",-1))),U={class:"field"},S={class:"control"},D=["disabled"],C={key:3,class:"notification is-danger"},P={key:1,class:"section box"},H={key:0,class:"container"},M={class:"field"},q={class:"control"},T=u((()=>(0,t._)("label",{class:"label"},"Enter code",-1))),x={key:1,class:"container"},$={key:0,class:"notification is-danger"},V={key:1,class:"container"},I={class:"field"},F={class:"control"},O=u((()=>(0,t._)("label",{class:"label"},"New Password:",-1))),E={class:"field"},L={class:"control"},z=u((()=>(0,t._)("label",{class:"label"},"Confirm Password:",-1))),A={class:"field"},Y={class:"control"},K=["disabled"],N={key:2,class:"container"},Z=u((()=>(0,t._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),W=[Z];var j={__name:"ForgotPassword",props:{userType:String,username:String,email:String},setup(a){const e=a;let s=(0,l.iH)(!1),o=(0,l.iH)(""),u=(0,l.iH)(!1),Z=(0,l.iH)(!1),j=(0,l.iH)(""),B=(0,l.iH)(!1),G=(0,l.iH)(!1),J=(0,l.iH)(""),Q=(0,l.iH)(""),R=(0,l.iH)(!1),X=(0,l.iH)(!1),aa=(0,l.iH)(!1),ea=(0,l.iH)(""),sa=(0,l.iH)(e.username),ta=(0,l.iH)(e.email);async function la(){if(null!=sa.value||null!=ta.value){let t;if(s.value=!0,await r().post("/api/code/email",{email:ta.value}).then((a=>t=a.data)),t)Z.value=!0;else if(Z.value=!1,"patient"==e.userType)if(await r().post("/api/user/verify_username",{username:sa.value,email:ta.value}).then((a=>ea.value=a.data)),ea.value){aa.value=!1;try{await r().post("/api/OTPMail",{email:ta.value}).then(B.value=!0),B.value=!0}catch(a){o.value=a}}else aa.value=!0;else if("doctor"==e.userType)if(await r().post("/api/doctor/verify_username",{username:sa.value,email:ta.value}).then((a=>ea.value=a.data)),ea.value){aa.value=!1;try{await r().post("/api/OTPMail",{email:ta.value}).then(B.value=!0),B.value=!0}catch(a){o.value=a}}else aa.value=!0;else if("manager"==e.userType)if(await r().post("/api/manager/verify_username",{username:sa.value,email:ta.value}).then((a=>ea.value=a.data)),ea.value){aa.value=!1;try{await r().post("/api/OTPMail",{email:ta.value}).then(B.value=!0),B.value=!0}catch(a){o.value=a}}else aa.value=!0;s.value=!1}}async function ia(){let a;G.value=!1,await r().post("/api/code/verify",{code:j.value}).then((e=>a=e.data)),a&&(G.value=!0)}async function na(){if(J.value===Q.value){if("patient"==e.userType)try{await r().put("/api/fupdatePassword/patient",{patientID:ea.value._id,password:J.value}),ea.value="",X.value=!0}catch(a){X.value=!1,o.value=a,ea.value=""}else if("doctor"==e.userType)try{await r().put("/api/fupdatePassword/doctor",{doctorID:ea.value._id,password:J.value}),ea.value="",X.value=!0}catch(a){X.value=!1,o.value=a,ea.value=""}else if("manager"==e.userType)try{await r().put("/api/fupdatePassword/manager",{managerID:ea.value._id,password:J.value}),ea.value="",X.value=!0}catch(a){X.value=!1,o.value=a,ea.value=""}}else R.value=!0}return(a,e)=>((0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("a",{class:"subtitle has-text-danger",onClick:e[0]||(e[0]=a=>(0,l.dq)(u)?u.value=!(0,l.SU)(u):u=!(0,l.SU)(u))},"Forgot Password"),(0,t._)("div",{class:(0,i.C_)(["modal",{"is-active":(0,l.SU)(u)}])},[c,(0,t._)("div",d,[(0,l.SU)(B)?((0,t.wg)(),(0,t.iD)("section",P,[(0,l.SU)(G)?((0,t.wg)(),(0,t.iD)("div",x,[(0,l.SU)(R)?((0,t.wg)(),(0,t.iD)("div",$,"Passwords not match.")):(0,t.kq)("",!0),(0,l.SU)(X)?((0,t.wg)(),(0,t.iD)("div",N,W)):((0,t.wg)(),(0,t.iD)("div",V,[(0,t._)("div",I,[(0,t._)("div",F,[O,(0,t.wy)((0,t._)("input",{class:"input",type:"password","onUpdate:modelValue":e[4]||(e[4]=a=>(0,l.dq)(J)?J.value=a:J=a)},null,512),[[n.nr,(0,l.SU)(J)]])])]),(0,t._)("div",E,[(0,t._)("div",L,[z,(0,t.wy)((0,t._)("input",{class:"input",type:"password","onUpdate:modelValue":e[5]||(e[5]=a=>(0,l.dq)(Q)?Q.value=a:Q=a)},null,512),[[n.nr,(0,l.SU)(Q)]])])]),(0,t._)("div",A,[(0,t._)("div",Y,[(0,t._)("button",{class:"button",onClick:na,disabled:""==(0,l.SU)(J)&&""==(0,l.SU)(Q)},"Confirm",8,K)])])]))])):((0,t.wg)(),(0,t.iD)("div",H,[(0,t._)("div",M,[(0,t._)("div",q,[T,(0,t.wy)((0,t._)("input",{class:"input",type:"number","onUpdate:modelValue":e[3]||(e[3]=a=>(0,l.dq)(j)?j.value=a:j=a)},null,512),[[n.nr,(0,l.SU)(j)]])])]),(0,t._)("div",{class:"field"},[(0,t._)("div",{class:"control"},[(0,t._)("button",{class:"button",onClick:ia},"Verify")])])]))])):((0,t.wg)(),(0,t.iD)("section",v,[p,(0,l.SU)(o)?((0,t.wg)(),(0,t.iD)("div",g,(0,i.zw)((0,l.SU)(o)),1)):(0,t.kq)("",!0),(0,l.SU)(aa)?((0,t.wg)(),(0,t.iD)("div",m,"No account has been found linked with this email.")):(0,t.kq)("",!0),(0,l.SU)(Z)?((0,t.wg)(),(0,t.iD)("div",C,"You have to wait 10 minutes before requesting a code again. ")):((0,t.wg)(),(0,t.iD)("div",w,[(0,t._)("div",h,[(0,t._)("div",_,[y,(0,t.wy)((0,t._)("input",{class:"input",type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>(0,l.dq)(sa)?sa.value=a:sa=a)},null,512),[[n.nr,(0,l.SU)(sa)]])])]),(0,t._)("div",f,[(0,t._)("div",b,[k,(0,t.wy)((0,t._)("input",{class:"input",type:"email","onUpdate:modelValue":e[2]||(e[2]=a=>(0,l.dq)(ta)?ta.value=a:ta=a)},null,512),[[n.nr,(0,l.SU)(ta)]])])]),(0,t._)("div",U,[(0,t._)("div",S,[(0,t._)("button",{class:(0,i.C_)(["button",{"is-loading":(0,l.SU)(s)}]),onClick:la,disabled:null==(0,l.SU)(ta)||null==(0,l.SU)(sa)},"Send OTP",10,D)])])]))]))]),(0,t._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=a=>(0,l.dq)(u)?u.value=!1:u=!1)})],2)],64))}},B=s(3744);const G=(0,B.Z)(j,[["__scopeId","data-v-c2f9401e"]]);var J=G},2479:function(a,e,s){s.r(e),s.d(e,{default:function(){return M}});var t=s(6252),l=s(9963),i=s(3577);const n=a=>((0,t.dD)("data-v-5bb54140"),a=a(),(0,t.Cn)(),a),o={class:"hero is-fullheight",style:{"background-color":"whitesmoke"}},r={class:"hero-body"},u={class:"container has-text-centered"},c={class:"animate__animated animate__fadeInLeft"},d={key:0,class:"notification is-success"},v={class:"box",style:{width:"33%",margin:"auto"}},p={class:"content"},g={class:"field",style:{"margin-top":"5%"}},m=n((()=>(0,t._)("h1",{class:"title"},"Login",-1))),w={class:"control"},h={class:"control",style:{"margin-top":"2%"}},_={key:0,class:"has-text-danger",style:{"margin-top":"5%"}},y={key:1,class:"has-text-danger",style:{"margin-top":"5%"}},f=n((()=>(0,t._)("hr",null,null,-1))),b=n((()=>(0,t._)("h1",{class:"title"},"Or",-1)));function k(a,e,s,n,k,U){const S=(0,t.up)("ForgotPassword");return(0,t.wg)(),(0,t.iD)("section",o,[(0,t._)("div",r,[(0,t._)("div",u,[(0,t._)("div",c,[k.newAccount?((0,t.wg)(),(0,t.iD)("p",d,"The account has been successfully created, login to activate the account now.")):(0,t.kq)("",!0),(0,t._)("div",v,[(0,t._)("div",p,[(0,t._)("form",g,[m,(0,t._)("div",w,[(0,t.wy)((0,t._)("input",{class:"input",type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>k.username=a),placeholder:"username",required:"",onKeyup:e[1]||(e[1]=(0,l.D2)(((...a)=>U.login&&U.login(...a)),["enter"]))},null,544),[[l.nr,k.username]])]),(0,t._)("div",h,[(0,t.wy)((0,t._)("input",{class:"input",type:"password","onUpdate:modelValue":e[2]||(e[2]=a=>k.password=a),placeholder:"password",required:"",onKeyup:e[3]||(e[3]=(0,l.D2)(((...a)=>U.login&&U.login(...a)),["enter"]))},null,544),[[l.nr,k.password]])]),k.incorrectUserPass?((0,t.wg)(),(0,t.iD)("p",_,(0,i.zw)(k.validateMessage),1)):0==k.incorrectUserPass?((0,t.wg)(),(0,t.iD)("p",y,(0,i.zw)(k.validateMessage),1)):(0,t.kq)("",!0),(0,t._)("button",{type:"button",class:"button is-primary",onClick:e[4]||(e[4]=(...a)=>U.login&&U.login(...a))},"Login"),f,b,(0,t._)("a",{onClick:e[5]||(e[5]=(...a)=>U.signup&&U.signup(...a)),class:"is-danger"},"Create an account")])]),(0,t.Wm)(S,{userType:"manager"})])])])])])}var U=s(9669),S=s.n(U),D=s(9885),C={name:"ManagerLogin",component:D["default"],data(){return{username:"",password:"",userManager:null,incorrectUserPass:"",validateMessage:"",newAccount:!1}},async mounted(){1==this.$store.state.accountCreated&&(this.newAccount=!0,await this.$store.commit("accountCreated",!1)),null!==this.$store.state.managerHospital&&await this.$router.push(`/user/manager/${this.$store.state.managerHospital}`)},methods:{async login(){null==this.username||null==this.password?(this.incorrectUserPass=!1,this.validateMessage="empty username or password",this.username=null,this.password=null):await S().post("/api/auth/manager",{username:this.username,password:this.password}).then((async a=>{this.userManager=a.data,await this.userManager?(await S().post("/session/manager",{_id:this.userManager._id,registrationCode:this.userManager.registrationCode,hospital:this.userManager.hospital}),this.$store.commit("managerHospital",this.userManager.hospital),await this.$router.push(`/user/manager/${this.userManager.hospital}`)):(this.validateMessage="Incorrect username or password",this.incorrectUserPass=!0,this.username=null,this.password=null)}))},async signup(){await this.$router.push("/user/manager/signup")}},components:{ForgotPassword:D["default"]}},P=s(3744);const H=(0,P.Z)(C,[["render",k],["__scopeId","data-v-5bb54140"]]);var M=H}}]);
//# sourceMappingURL=479.c8ec7ae8.js.map