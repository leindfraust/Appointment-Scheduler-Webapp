"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[848],{2848:function(a,e,l){l.r(e),l.d(e,{default:function(){return W}});var i=l(6252),s=l(2262),t=l(3577),n=l(9963),u=l(9669),o=l.n(u);const c=a=>((0,i.dD)("data-v-29b358e4"),a=a(),(0,i.Cn)(),a),d=c((()=>(0,i._)("div",{class:"modal-background"},null,-1))),v={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},r={key:0,class:"section box"},p=c((()=>(0,i._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),w={key:0,class:"notification is-danger"},f={key:1,class:"notification is-warning"},_={key:2,class:"container"},y={class:"field"},m={class:"control"},g=c((()=>(0,i._)("label",{class:"label"},"Enter Username",-1))),b={class:"field"},h={class:"control"},U=c((()=>(0,i._)("label",{class:"label"},"Enter Email",-1))),k={class:"field"},S={class:"control"},D=["disabled"],H={key:3,class:"notification is-danger"},P={key:1,class:"section box"},q={key:0,class:"container"},C={key:0,class:"notification is-warning"},T={class:"field"},V={class:"control"},x=c((()=>(0,i._)("label",{class:"label"},"Enter code",-1))),I={key:1,class:"container"},E={key:0,class:"notification is-danger"},O={key:1,class:"container"},F={class:"field"},M={class:"control"},Y=c((()=>(0,i._)("label",{class:"label"},"New Password:",-1))),N={class:"field"},z={class:"control"},Z=c((()=>(0,i._)("label",{class:"label"},"Confirm Password:",-1))),j={class:"field"},A={class:"control"},B=["disabled"],G={key:2,class:"container"},J=c((()=>(0,i._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),K=[J];var L={__name:"ForgotPassword",props:{userType:String,username:String,email:String},setup(a){const e=a;let l=(0,s.iH)(!1),u=(0,s.iH)(""),c=(0,s.iH)(!1),J=(0,s.iH)(!1),L=(0,s.iH)(""),Q=(0,s.iH)(!1),R=(0,s.iH)(!1),W=(0,s.iH)(!1),X=(0,s.iH)(""),$=(0,s.iH)(""),aa=(0,s.iH)(!1),ea=(0,s.iH)(!1),la=(0,s.iH)(!1),ia=(0,s.iH)(""),sa=(0,s.iH)(e.username),ta=(0,s.iH)(e.email);async function na(){if(null!=sa.value||null!=ta.value){let i;if(l.value=!0,await o().post("/api/code/email",{email:ta.value}).then((a=>i=a.data)),i)J.value=!0;else if(J.value=!1,"patient"==e.userType)if(await o().post("/api/user/verify_username",{username:sa.value,email:ta.value}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await o().post("/api/OTPMail",{email:ta.value}).then(Q.value=!0),Q.value=!0}catch(a){u.value=a}}else la.value=!0;else if("doctor"==e.userType)if(await o().post("/api/doctor/verify_username",{username:sa.value,email:ta.value}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await o().post("/api/OTPMail",{email:ta.value}).then(Q.value=!0),Q.value=!0}catch(a){u.value=a}}else la.value=!0;else if("manager"==e.userType)if(await o().post("/api/manager/verify_username",{username:sa.value,email:ta.value}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await o().post("/api/OTPMail",{email:ta.value}).then(Q.value=!0),Q.value=!0}catch(a){u.value=a}}else la.value=!0;l.value=!1}}async function ua(){let a;W.value=!1,R.value=!1,await o().post("/api/code/verify",{code:L.value}).then((e=>a=e.data)),a?R.value=!0:W.value=!0}async function oa(){if(X.value===$.value){if("patient"==e.userType)try{await o().put("/api/fupdatePassword/patient",{patientID:ia.value._id,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,u.value=a,ia.value=""}else if("doctor"==e.userType)try{await o().put("/api/fupdatePassword/doctor",{doctorID:ia.value._id,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,u.value=a,ia.value=""}else if("manager"==e.userType)try{await o().put("/api/fupdatePassword/manager",{managerID:ia.value._id,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,u.value=a,ia.value=""}}else aa.value=!0}return(a,e)=>((0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("a",{class:"subtitle has-text-danger",onClick:e[0]||(e[0]=a=>(0,s.dq)(c)?c.value=!(0,s.SU)(c):c=!(0,s.SU)(c))},"Forgot Password"),(0,i._)("div",{class:(0,t.C_)(["modal",{"is-active":(0,s.SU)(c)}])},[d,(0,i._)("div",v,[(0,s.SU)(Q)?((0,i.wg)(),(0,i.iD)("section",P,[(0,s.SU)(R)?((0,i.wg)(),(0,i.iD)("div",I,[(0,s.SU)(aa)?((0,i.wg)(),(0,i.iD)("div",E,"Passwords not match.")):(0,i.kq)("",!0),(0,s.SU)(ea)?((0,i.wg)(),(0,i.iD)("div",G,K)):((0,i.wg)(),(0,i.iD)("div",O,[(0,i._)("div",F,[(0,i._)("div",M,[Y,(0,i.wy)((0,i._)("input",{class:"input",type:"password","onUpdate:modelValue":e[4]||(e[4]=a=>(0,s.dq)(X)?X.value=a:X=a)},null,512),[[n.nr,(0,s.SU)(X)]])])]),(0,i._)("div",N,[(0,i._)("div",z,[Z,(0,i.wy)((0,i._)("input",{class:"input",type:"password","onUpdate:modelValue":e[5]||(e[5]=a=>(0,s.dq)($)?$.value=a:$=a)},null,512),[[n.nr,(0,s.SU)($)]])])]),(0,i._)("div",j,[(0,i._)("div",A,[(0,i._)("button",{class:"button",onClick:oa,disabled:""==(0,s.SU)(X)&&""==(0,s.SU)($)},"Confirm",8,B)])])]))])):((0,i.wg)(),(0,i.iD)("div",q,[(0,s.SU)(W)?((0,i.wg)(),(0,i.iD)("div",C,"Incorrect code, please try again.")):(0,i.kq)("",!0),(0,i._)("div",T,[(0,i._)("div",V,[x,(0,i.wy)((0,i._)("input",{class:"input",type:"number","onUpdate:modelValue":e[3]||(e[3]=a=>(0,s.dq)(L)?L.value=a:L=a)},null,512),[[n.nr,(0,s.SU)(L)]])])]),(0,i._)("div",{class:"field"},[(0,i._)("div",{class:"control"},[(0,i._)("button",{class:"button",onClick:ua},"Verify")])])]))])):((0,i.wg)(),(0,i.iD)("section",r,[p,(0,s.SU)(u)?((0,i.wg)(),(0,i.iD)("div",w,(0,t.zw)((0,s.SU)(u)),1)):(0,i.kq)("",!0),(0,s.SU)(la)?((0,i.wg)(),(0,i.iD)("div",f,"No account has been found linked with this email.")):(0,i.kq)("",!0),(0,s.SU)(J)?((0,i.wg)(),(0,i.iD)("div",H,"You have to wait 10 minutes before requesting a code again. ")):((0,i.wg)(),(0,i.iD)("div",_,[(0,i._)("div",y,[(0,i._)("div",m,[g,(0,i.wy)((0,i._)("input",{class:"input",type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>(0,s.dq)(sa)?sa.value=a:sa=a)},null,512),[[n.nr,(0,s.SU)(sa)]])])]),(0,i._)("div",b,[(0,i._)("div",h,[U,(0,i.wy)((0,i._)("input",{class:"input",type:"email","onUpdate:modelValue":e[2]||(e[2]=a=>(0,s.dq)(ta)?ta.value=a:ta=a)},null,512),[[n.nr,(0,s.SU)(ta)]])])]),(0,i._)("div",k,[(0,i._)("div",S,[(0,i._)("button",{class:(0,t.C_)(["button",{"is-loading":(0,s.SU)(l)}]),onClick:na,disabled:null==(0,s.SU)(ta)||null==(0,s.SU)(sa)},"Send OTP",10,D)])])]))]))]),(0,i._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=a=>(0,s.dq)(c)?c.value=!1:c=!1)})],2)],64))}},Q=l(3744);const R=(0,Q.Z)(L,[["__scopeId","data-v-29b358e4"]]);var W=R}}]);
//# sourceMappingURL=848.d8fdaae1.js.map