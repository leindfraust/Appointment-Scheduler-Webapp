"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[477],{6919:function(t,e,s){s.d(e,{Z:function(){return E}});var a=s(6252),i=s(3577);const l=t=>((0,a.dD)("data-v-adff8ddc"),t=t(),(0,a.Cn)(),t),d={class:"navbar is-hidden-desktop"},o={class:"navbar-brand"},n={class:"navbar-item"},c={class:"label"},u=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),r=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),h=l((()=>(0,a._)("span",{"aria-hidden":"true"},null,-1))),p=[u,r,h],m={class:"has-text-centered block",style:{padding:"5px"}},g={class:"is-hidden-mobile is-hidden-touch image image-outer is-square",style:{margin:"auto"}},_=["src"],y={key:0,class:"title is-6"},b={class:"menu-list block"},S=l((()=>(0,a._)("p",{class:"menu-label"},"General",-1))),v=l((()=>(0,a._)("p",{class:"menu-label"},"Verification and Information",-1))),w=l((()=>(0,a._)("p",{class:"menu-label"},"Support",-1))),f={class:"block has-text-centered"};function D(t,e,s,l,u,r){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("nav",d,[(0,a._)("div",o,[(0,a._)("a",n,[(0,a._)("label",c,"Dr. "+(0,i.zw)(t.$store.state.doctorName),1)]),(0,a._)("a",{role:"button",class:(0,i.C_)(["navbar-burger",{"is-active":!u.isActive}]),"aria-label":"menu","aria-expanded":"false","data-target":"navbar",onClick:e[0]||(e[0]=(...t)=>r.menuNav&&r.menuNav(...t))},p,2)])]),(0,a._)("aside",{class:(0,i.C_)(["menu box",{"is-hidden-mobile":u.isActive,fixedMenu:u.isActive}]),style:{"background-color":"#D8E5FF",padding:"20px"}},[(0,a._)("div",m,[(0,a._)("figure",g,[(0,a._)("img",{class:"is-rounded image-inner",src:`http://res.cloudinary.com/leindfraust/image/upload/v${(new Date).getMonth()}${(new Date).getDate()}/assets/doctors/${u.alias}.jpg`},null,8,_)]),u.isActive?((0,a.wg)(),(0,a.iD)("h5",y,"Dr. "+(0,i.zw)(t.$store.state.doctorName),1)):(0,a.kq)("",!0)]),(0,a._)("ul",b,[S,(0,a._)("li",null,[(0,a._)("a",{onClick:e[1]||(e[1]=(...t)=>r.routeHome&&r.routeHome(...t))},"Appointments")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[2]||(e[2]=(...t)=>r.patientLogs&&r.patientLogs(...t))},"Patient History")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[3]||(e[3]=(...t)=>r.openSchedule&&r.openSchedule(...t))},"Schedule")]),v,(0,a._)("li",null,[(0,a._)("a",{onClick:e[4]||(e[4]=(...t)=>r.profile&&r.profile(...t))},"Profile")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[5]||(e[5]=(...t)=>r.openSecurity&&r.openSecurity(...t))},"Security")]),w,(0,a._)("li",null,[(0,a._)("a",{onClick:e[6]||(e[6]=(...e)=>t.openFAQs&&t.openFAQs(...e))},"FAQ")]),(0,a._)("li",null,[(0,a._)("a",{onClick:e[7]||(e[7]=t=>this.$router.push("/contactus"))},"Contact Us")])]),(0,a._)("div",f,[(0,a._)("button",{onClick:e[8]||(e[8]=(...t)=>r.logout&&r.logout(...t)),class:"button is-link is-rounded",type:"button"},"Logout")])],2)],64)}var k=s(4239),x=s(9669),C=s.n(x),$={name:"AdminMenu",data(){return{alias:k.Z.state.alias,isActive:!0}},methods:{async logout(){k.Z.commit("alias",null),await C()["delete"]("/session/doctor"),await this.$router.push("/doctor/login")},async routeHome(){await this.$router.push(`/doctor/${this.alias}`)},async profile(){await this.$router.push(`/doctor/${this.alias}/profile`)},async patientLogs(){await this.$router.push(`/doctor/${this.alias}/patients`)},async openSecurity(){await this.$router.push(`/doctor/${this.alias}/security`)},async openSchedule(){await this.$router.push(`/doctor/${this.alias}/schedule`)},menuNav(){this.isActive=!this.isActive}}},L=s(3744);const z=(0,L.Z)($,[["render",D],["__scopeId","data-v-adff8ddc"]]);var E=z},3477:function(t,e,s){s.r(e),s.d(e,{default:function(){return ut}});var a=s(6252),i=s(3577),l=s(9963);const d={class:"main-doctor"},o={class:"columns"},n={class:"column is-2"},c={class:"column"},u={class:"section"},r=(0,a._)("h1",{class:"title"},"SET SCHEDULES",-1),h=(0,a._)("div",{class:"modal-background"},null,-1),p={class:"modal-content"},m={class:"card"},g={class:"card-content"},_={class:"content has-text-centered"},y={class:"control block"},b=(0,a._)("label",{class:"label"},"Prefix:",-1),S={class:"select block"},v=["value"],w=(0,a._)("label",{class:"label"},"Time start:",-1),f=(0,a._)("br",null,null,-1),D=(0,a._)("label",{class:"label"},"Time end:",-1),k={class:"control block"},x=(0,a._)("label",{class:"label"},"Appointment limit:",-1),C={class:"block"},$=["disabled"],L=(0,a._)("div",{class:"modal-background"},null,-1),z=(0,a._)("div",{class:"modal-content loader"},null,-1),E=[L,z],H={class:"columns"},A={class:"column"},M={key:0,class:"notification is-success has-text-centered"},I={class:"column"},V={class:"container"},U=(0,a._)("h1",{class:"subtitle has-text-weight-bold"},"Ongoing Schedules:",-1),O={key:0,class:"columns is-multiline",style:{overflow:"scroll","max-height":"30em"}},Z={class:"block card"},P={class:"card-content"},T={class:"buttons is-right"},N=["onClick"],F=(0,a._)("i",{class:"fa-solid fa-pen-to-square"},null,-1),q=[F],W=["onClick"],K=(0,a._)("i",{class:"fa-solid fa-trash-can"},null,-1),Q=[K],Y={class:"content"},j={class:"title is-5 has-text-black has-text-left"},G={class:"has-text-black"},R={class:"has-text-black"},B={class:"has-text-black"},J={class:"has-text-black"},X={key:1,class:"notification is-warning"},tt=(0,a._)("h1",{class:"title is-5"},"No ongoing schedules.",-1),et=[tt];function st(t,e,s,L,z,F){const K=(0,a.up)("DoctorMenu"),tt=(0,a.up)("v-date-picker"),st=(0,a.up)("v-calendar");return(0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("div",o,[(0,a._)("div",n,[(0,a.Wm)(K)]),(0,a._)("div",c,[(0,a._)("section",u,[r,(0,a._)("div",{class:(0,i.C_)(["modal",{"is-active":z.toggleModalSchedule}])},[h,(0,a._)("div",p,[(0,a._)("div",m,[(0,a._)("div",g,[(0,a._)("div",_,[(0,a._)("div",y,[b,(0,a.wy)((0,a._)("input",{class:"input",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>z.prefix=t),style:{width:"33%"},placeholder:"e.g. ROOM305"},null,512),[[l.nr,z.prefix]])]),(0,a._)("div",S,[(0,a.wy)((0,a._)("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>z.selectedHospital=t)},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(z.hospitalList,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t,value:t.hospital},(0,i.zw)(t.hospital),9,v)))),128))],512),[[l.bM,z.selectedHospital]])]),w,(0,a.Wm)(tt,{modelValue:z.timeStart,"onUpdate:modelValue":e[2]||(e[2]=t=>z.timeStart=t),mode:"time",timezone:z.timezone,class:"block"},null,8,["modelValue","timezone"]),f,D,(0,a.Wm)(tt,{modelValue:z.timeEnd,"onUpdate:modelValue":e[3]||(e[3]=t=>z.timeEnd=t),mode:"time",timezone:z.timezone,class:"block"},null,8,["modelValue","timezone"]),(0,a._)("div",k,[x,(0,a.wy)((0,a._)("input",{class:"input",type:"number","onUpdate:modelValue":e[4]||(e[4]=t=>z.appointmentLimits=t),style:{width:"33%"}},null,512),[[l.nr,z.appointmentLimits]])]),(0,a._)("div",C,[(0,a._)("button",{class:(0,i.C_)(["button",{"is-primary":!z.updateSchedule,"is-info":z.updateSchedule}]),type:"button",onClick:e[5]||(e[5]=(...t)=>F.uploadSched&&F.uploadSched(...t)),disabled:""==z.prefix},(0,i.zw)(z.updateSchedule?"Update Schedule":"Add Schedule"),11,$)])])])])]),(0,a._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=(...t)=>F.modalClose&&F.modalClose(...t))})],2),(0,a._)("div",{class:(0,i.C_)(["modal",{"is-active":z.loading}])},E,2),(0,a._)("div",H,[(0,a._)("div",A,[z.uploadSchedSuccess?((0,a.wg)(),(0,a.iD)("div",M,"Schedules Added/Updated! ")):(0,a.kq)("",!0),(0,a.Wm)(st,{columns:t.$screens({default:1,lg:2}),rows:t.$screens({default:1,lg:2}),"is-expanded":t.$screens({default:!0,lg:!1}),modelValue:z.date,"onUpdate:modelValue":e[7]||(e[7]=t=>z.date=t),"min-date":new Date,"disabled-dates":[{start:new Date,end:new Date}],attributes:F.attributes,onDayclick:F.modalSchedPrompt,timezone:z.timezone},null,8,["columns","rows","is-expanded","modelValue","min-date","disabled-dates","attributes","onDayclick","timezone"])]),(0,a._)("div",I,[(0,a._)("div",V,[U,0!==Object.keys(F.daysIndexed).length?((0,a.wg)(),(0,a.iD)("div",O,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(F.daysIndexed,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"column is-6",key:t.id},[(0,a._)("div",Z,[(0,a._)("div",P,[(0,a._)("div",T,[(0,a._)("button",{class:"button",onClick:e=>F.modalSchedEdit(t)},q,8,N),(0,a._)("button",{class:"button",onClick:e=>F.modalSchedDelete(t.dayDetail)},Q,8,W)]),(0,a._)("div",Y,[(0,a._)("p",j,(0,i.zw)(new Date(t.date).toDateString()),1),(0,a._)("p",G,"Prefix: "+(0,i.zw)(t.prefix),1),(0,a._)("p",R,"Hospital: "+(0,i.zw)(t.hospital),1),(0,a._)("p",B,(0,i.zw)(t.timeStart)+" - "+(0,i.zw)(t.timeEnd),1),(0,a._)("p",J,"Appointment limit: "+(0,i.zw)(t.appointmentLimit),1)])])])])))),128))])):((0,a.wg)(),(0,a.iD)("div",X,et))])])])])])])])}var at=s(9669),it=s.n(at),lt=s(4239),dt=s(6919),ot={name:"SchedulerPage",components:{DoctorMenu:dt.Z},data(){return{alias:lt.Z.state.alias,profileImg:lt.Z.state.profileImg,userID:"",date:new Date,timeStart:"",timeEnd:"",timezone:"Asia/Hong_Kong",prefix:"",days:[],day:"",appointmentLimits:10,checkServer:null,toggleModalSchedule:!1,uploadSchedSuccess:!1,loading:!1,hospitalList:[],selectedHospital:"",updateSchedule:!1}},async mounted(){await it().get("/session/doctor").then((t=>this.days=t.data.schedule)),await it().get("/session/doctor").then((t=>this.userID=t.data._id)),await it().get("/session/doctor").then((t=>this.hospitalList=t.data.hospitalOrigin)),this.selectedHospital=await this.hospitalList[0].hospital},computed:{attributes(){return this.days.map((t=>({highlight:!0,dates:new Date(t.date).toDateString(),popover:{label:`${t.hospital}, ${t.timeStart} - ${t.timeEnd}`}})))},daysIndexed(){return""!==this.days&&this.sortDate()}},methods:{sortDate(){return this.days.sort(((t,e)=>{new Date(t.id),new Date(e.id)})).filter((t=>new Date(t.id)>new Date))},timeStringConvert(t,e){return e.setHours(t.substr(0,t.indexOf(":"))),e.setMinutes(t.substr(3,t.indexOf(":"))),e.setSeconds(t.substr(6,t.indexOf(":"))),e},async uploadSched(){if(this.loading=!0,this.updateSchedule)try{await it().put(`/api/doctor/schedule_update/${this.userID}`,{schedule:{dayDetail:this.day,id:this.day.id,date:this.day.date,timeStart:this.timeStart.toLocaleTimeString(),timeEnd:this.timeEnd.toLocaleTimeString(),appointmentLimit:this.appointmentLimits,prefix:this.prefix,hospital:this.selectedHospital}}).then((async t=>{await it().put("/session/doctor",{schedule:t.data.schedule}),this.days=t.data.schedule}))}catch(t){console.log(t)}else{this.days.push({dayDetail:this.day,id:this.day.id,date:this.day.date,timeStart:this.timeStart.toLocaleTimeString(),timeEnd:this.timeEnd.toLocaleTimeString(),appointmentLimit:this.appointmentLimits,prefix:this.prefix,hospital:this.selectedHospital});try{await it().put(`/api/doctor/${this.userID}`,{schedule:this.days}),await it().put("/session/doctor",{schedule:this.days}),await it().get("/session/doctor").then((t=>this.days=t.data.schedule))}catch(t){console.log(t)}}this.toggleModalSchedule=!1,this.updateSchedule=!1,this.uploadSchedSuccess=!0,this.loading=!1},async modalSchedDelete(t){if(!t?.isDisabled){this.toggleModalSchedule=!0;const s=this.days.findIndex((e=>e.id===t.id));if(s>=0){this.loading=!0,this.days.splice(s,1),this.toggleModalSchedule=!1;try{await it().put(`/api/doctor/${this.userID}`,{schedule:this.days}),await it().put("/session/doctor",{schedule:this.days}),await it().get("/session/doctor").then((t=>this.days=t.data.schedule))}catch(e){console.log(e)}this.uploadSchedSuccess=!0,this.loading=!1}}},async modalSchedPrompt(t){if(t?.isDisabled||0!=t.attributes.length){const e=this.days.find((e=>e.id==t.id));this.modalSchedEdit(e)}else this.toggleModalSchedule=!0,this.day=t,this.timeStart=t.date,this.timeEnd=t.date},async modalSchedEdit(t){t.dayDetail?.isDisabled||(this.updateSchedule=!0,this.toggleModalSchedule=!0,this.prefix=t.prefix,this.day=t.dayDetail,this.timeStart=this.timeStringConvert(t.timeStart,new Date(t.dayDetail.date)),this.timeEnd=this.timeStringConvert(t.timeEnd,new Date(t.dayDetail.date)),this.appointmentLimits=t.appointmentLimit,this.selectedHospital=t.hospital)},modalClose(){this.toggleModalSchedule=!this.toggleModalSchedule,this.updateSchedule=!1,this.prefix="",this.day="",this.timeStart="",this.timeEnd="",this.appointmentLimits=10}}},nt=s(3744);const ct=(0,nt.Z)(ot,[["render",st]]);var ut=ct}}]);
//# sourceMappingURL=477.5e6c1d83.js.map