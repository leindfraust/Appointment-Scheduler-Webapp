"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[345],{7345:function(a,e,l){l.r(e),l.d(e,{default:function(){return R}});var i=l(6252),s=l(2262),t=l(3577),n=l(9963),u=l(594);const o=a=>((0,i.dD)("data-v-3decfc24"),a=a(),(0,i.Cn)(),a),c=o((()=>(0,i._)("div",{class:"modal-background"},null,-1))),d={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},r={key:0,class:"section box"},v=o((()=>(0,i._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),p={key:0,class:"notification is-danger"},w={key:1,class:"notification is-warning"},f={key:2,class:"container"},y={class:"field"},m={class:"control"},_=o((()=>(0,i._)("label",{class:"label"},"Enter Username",-1))),g={class:"field"},b={class:"control"},h=o((()=>(0,i._)("label",{class:"label"},"Enter Email",-1))),k={class:"field"},U={class:"control"},S=["disabled"],D={key:3,class:"notification is-danger"},H={key:1,class:"section box"},P={key:0,class:"container"},C={key:0,class:"notification is-warning"},q={class:"field"},Z={class:"control"},T=o((()=>(0,i._)("label",{class:"label"},"Enter code",-1))),V={key:1,class:"container"},x={key:0,class:"notification is-danger"},I={key:1,class:"container"},E={class:"field"},F={class:"control"},O=o((()=>(0,i._)("label",{class:"label"},"New Password:",-1))),M={class:"field"},N={class:"control"},Y=o((()=>(0,i._)("label",{class:"label"},"Confirm Password:",-1))),z={class:"field"},j={class:"control"},A=["disabled"],B={key:2,class:"container"},G=o((()=>(0,i._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),J=[G];var K={__name:"ForgotPassword",props:{userType:String,username:String,email:String,forgotPasswordPromptCount:{type:Number,default:0}},setup(a){const e=a;let l=(0,s.iH)(!1),o=(0,s.iH)(""),G=(0,s.iH)(!1),K=(0,s.iH)(!1),L=(0,s.iH)(""),Q=(0,s.iH)(!1),R=(0,s.iH)(!1),W=(0,s.iH)(!1),X=(0,s.iH)(""),$=(0,s.iH)(""),aa=(0,s.iH)(!1),ea=(0,s.iH)(!1),la=(0,s.iH)(!1),ia=(0,s.iH)(""),sa=(0,s.iH)(e.username),ta=(0,s.iH)(e.email);const na=(0,s.iH)(2),ua=(0,i.Fl)((()=>e.forgotPasswordPromptCount));async function oa(){if(null!=sa.value||null!=ta.value){let i;if(l.value=!0,await u.Z.post("/api/code/email",{email:ta.value}).then((a=>i=a.data)),i)K.value=!0;else if(K.value=!1,"patient"==e.userType)if(await u.Z.post("/api/user/verify_username",{username:sa.value,email:ta.value}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await u.Z.post("/api/OTPMail",{email:ta.value}).then(Q.value=!0),Q.value=!0}catch(a){o.value=a}}else la.value=!0;else if("doctor"==e.userType)if(await u.Z.post("/api/doctor/verify_username",{username:sa.value,email:ta.value}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await u.Z.post("/api/OTPMail",{email:ta.value}).then(Q.value=!0),Q.value=!0}catch(a){o.value=a}}else la.value=!0;else if("manager"==e.userType)if(await u.Z.post("/api/manager/verify_username",{username:sa.value,email:ta.value}).then((a=>ia.value=a.data)),ia.value){la.value=!1;try{await u.Z.post("/api/OTPMail",{email:ta.value}).then(Q.value=!0),Q.value=!0}catch(a){o.value=a}}else la.value=!0;l.value=!1}}async function ca(){let a;W.value=!1,R.value=!1,await u.Z.post("/api/code/verify",{code:L.value}).then((e=>a=e.data)),a?R.value=!0:W.value=!0}async function da(){if(X.value===$.value){if("patient"==e.userType)try{await u.Z.put("/api/fupdatePassword/patient",{patientID:ia.value._id,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,ia.value=""}else if("doctor"==e.userType)try{await u.Z.put("/api/fupdatePassword/doctor",{doctorID:ia.value._id,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,ia.value=""}else if("manager"==e.userType)try{await u.Z.put("/api/fupdatePassword/manager",{managerID:ia.value._id,password:X.value}),ia.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,ia.value=""}}else aa.value=!0}return(a,e)=>((0,i.wg)(),(0,i.iD)(i.HY,null,[(0,s.SU)(ua)>=na.value?((0,i.wg)(),(0,i.iD)("a",{key:0,class:"help has-text-danger",onClick:e[0]||(e[0]=a=>(0,s.dq)(G)?G.value=!(0,s.SU)(G):G=!(0,s.SU)(G))},"Forgot Password")):(0,i.kq)("",!0),(0,i._)("div",{class:(0,t.C_)(["modal",{"is-active":(0,s.SU)(G)}])},[c,(0,i._)("div",d,[(0,s.SU)(Q)?((0,i.wg)(),(0,i.iD)("section",H,[(0,s.SU)(R)?((0,i.wg)(),(0,i.iD)("div",V,[(0,s.SU)(aa)?((0,i.wg)(),(0,i.iD)("div",x,"Passwords not match.")):(0,i.kq)("",!0),(0,s.SU)(ea)?((0,i.wg)(),(0,i.iD)("div",B,J)):((0,i.wg)(),(0,i.iD)("div",I,[(0,i._)("div",E,[(0,i._)("div",F,[O,(0,i.wy)((0,i._)("input",{class:"input",type:"password","onUpdate:modelValue":e[4]||(e[4]=a=>(0,s.dq)(X)?X.value=a:X=a)},null,512),[[n.nr,(0,s.SU)(X)]])])]),(0,i._)("div",M,[(0,i._)("div",N,[Y,(0,i.wy)((0,i._)("input",{class:"input",type:"password","onUpdate:modelValue":e[5]||(e[5]=a=>(0,s.dq)($)?$.value=a:$=a)},null,512),[[n.nr,(0,s.SU)($)]])])]),(0,i._)("div",z,[(0,i._)("div",j,[(0,i._)("button",{class:"button",onClick:da,disabled:""==(0,s.SU)(X)&&""==(0,s.SU)($)},"Confirm",8,A)])])]))])):((0,i.wg)(),(0,i.iD)("div",P,[(0,s.SU)(W)?((0,i.wg)(),(0,i.iD)("div",C,"Incorrect code, please try again.")):(0,i.kq)("",!0),(0,i._)("div",q,[(0,i._)("div",Z,[T,(0,i.wy)((0,i._)("input",{class:"input",type:"number","onUpdate:modelValue":e[3]||(e[3]=a=>(0,s.dq)(L)?L.value=a:L=a)},null,512),[[n.nr,(0,s.SU)(L)]])])]),(0,i._)("div",{class:"field"},[(0,i._)("div",{class:"control"},[(0,i._)("button",{class:"button",onClick:ca},"Verify")])])]))])):((0,i.wg)(),(0,i.iD)("section",r,[v,(0,s.SU)(o)?((0,i.wg)(),(0,i.iD)("div",p,(0,t.zw)((0,s.SU)(o)),1)):(0,i.kq)("",!0),(0,s.SU)(la)?((0,i.wg)(),(0,i.iD)("div",w,"No account has been found linked with this email.")):(0,i.kq)("",!0),(0,s.SU)(K)?((0,i.wg)(),(0,i.iD)("div",D,"You have to wait 10 minutes before requesting a code again. ")):((0,i.wg)(),(0,i.iD)("div",f,[(0,i._)("div",y,[(0,i._)("div",m,[_,(0,i.wy)((0,i._)("input",{class:"input",type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>(0,s.dq)(sa)?sa.value=a:sa=a)},null,512),[[n.nr,(0,s.SU)(sa)]])])]),(0,i._)("div",g,[(0,i._)("div",b,[h,(0,i.wy)((0,i._)("input",{class:"input",type:"email","onUpdate:modelValue":e[2]||(e[2]=a=>(0,s.dq)(ta)?ta.value=a:ta=a)},null,512),[[n.nr,(0,s.SU)(ta)]])])]),(0,i._)("div",k,[(0,i._)("div",U,[(0,i._)("button",{class:(0,t.C_)(["button",{"is-loading":(0,s.SU)(l)}]),onClick:oa,disabled:null==(0,s.SU)(ta)||null==(0,s.SU)(sa)},"Send OTP",10,S)])])]))]))]),(0,i._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=a=>(0,s.dq)(G)?G.value=!1:G=!1)})],2)],64))}},L=l(3744);const Q=(0,L.Z)(K,[["__scopeId","data-v-3decfc24"]]);var R=Q}}]);
//# sourceMappingURL=345.9fbdc55e.js.map