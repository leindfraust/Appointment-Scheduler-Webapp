"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[868,885],{9885:function(e,a,s){s.r(a),s.d(a,{default:function(){return G}});var t=s(6252),i=s(2262),l=s(3577),n=s(9963),u=s(9669),r=s.n(u);const o=e=>((0,t.dD)("data-v-c2f9401e"),e=e(),(0,t.Cn)(),e),c=o((()=>(0,t._)("div",{class:"modal-background"},null,-1))),d={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},v={key:0,class:"section box"},p=o((()=>(0,t._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),m={key:0,class:"notification is-danger"},h={key:1,class:"notification is-warning"},w={key:2,class:"container"},_={class:"field"},y={class:"control"},f=o((()=>(0,t._)("label",{class:"label"},"Enter Username",-1))),g={class:"field"},b={class:"control"},U=o((()=>(0,t._)("label",{class:"label"},"Enter Email",-1))),P={class:"field"},k={class:"control"},D=["disabled"],S={key:3,class:"notification is-danger"},C={key:1,class:"section box"},H={key:0,class:"container"},q={class:"field"},x={class:"control"},T=o((()=>(0,t._)("label",{class:"label"},"Enter code",-1))),I={key:1,class:"container"},M={key:0,class:"notification is-danger"},$={key:1,class:"container"},V={class:"field"},A={class:"control"},E=o((()=>(0,t._)("label",{class:"label"},"New Password:",-1))),F={class:"field"},O={class:"control"},Y=o((()=>(0,t._)("label",{class:"label"},"Confirm Password:",-1))),Z={class:"field"},z={class:"control"},L=["disabled"],K={key:2,class:"container"},N=o((()=>(0,t._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),R=[N];var B={__name:"ForgotPassword",props:{userType:String,username:String,email:String},setup(e){const a=e;let s=(0,i.iH)(!1),u=(0,i.iH)(""),o=(0,i.iH)(!1),N=(0,i.iH)(!1),B=(0,i.iH)(""),W=(0,i.iH)(!1),j=(0,i.iH)(!1),G=(0,i.iH)(""),J=(0,i.iH)(""),Q=(0,i.iH)(!1),X=(0,i.iH)(!1),ee=(0,i.iH)(!1),ae=(0,i.iH)(""),se=(0,i.iH)(a.username),te=(0,i.iH)(a.email);async function ie(){if(null!=se.value||null!=te.value){let t;if(s.value=!0,await r().post("/api/code/email",{email:te.value}).then((e=>t=e.data)),t)N.value=!0;else if(N.value=!1,"patient"==a.userType)if(await r().post("/api/user/verify_username",{username:se.value,email:te.value}).then((e=>ae.value=e.data)),ae.value){ee.value=!1;try{await r().post("/api/OTPMail",{email:te.value}).then(W.value=!0),W.value=!0}catch(e){u.value=e}}else ee.value=!0;else if("doctor"==a.userType)if(await r().post("/api/doctor/verify_username",{username:se.value,email:te.value}).then((e=>ae.value=e.data)),ae.value){ee.value=!1;try{await r().post("/api/OTPMail",{email:te.value}).then(W.value=!0),W.value=!0}catch(e){u.value=e}}else ee.value=!0;else if("manager"==a.userType)if(await r().post("/api/manager/verify_username",{username:se.value,email:te.value}).then((e=>ae.value=e.data)),ae.value){ee.value=!1;try{await r().post("/api/OTPMail",{email:te.value}).then(W.value=!0),W.value=!0}catch(e){u.value=e}}else ee.value=!0;s.value=!1}}async function le(){let e;j.value=!1,await r().post("/api/code/verify",{code:B.value}).then((a=>e=a.data)),e&&(j.value=!0)}async function ne(){if(G.value===J.value){if("patient"==a.userType)try{await r().put("/api/fupdatePassword/patient",{patientID:ae.value._id,password:G.value}),ae.value="",X.value=!0}catch(e){X.value=!1,u.value=e,ae.value=""}else if("doctor"==a.userType)try{await r().put("/api/fupdatePassword/doctor",{doctorID:ae.value._id,password:G.value}),ae.value="",X.value=!0}catch(e){X.value=!1,u.value=e,ae.value=""}else if("manager"==a.userType)try{await r().put("/api/fupdatePassword/manager",{managerID:ae.value._id,password:G.value}),ae.value="",X.value=!0}catch(e){X.value=!1,u.value=e,ae.value=""}}else Q.value=!0}return(e,a)=>((0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("a",{class:"subtitle has-text-danger",onClick:a[0]||(a[0]=e=>(0,i.dq)(o)?o.value=!(0,i.SU)(o):o=!(0,i.SU)(o))},"Forgot Password"),(0,t._)("div",{class:(0,l.C_)(["modal",{"is-active":(0,i.SU)(o)}])},[c,(0,t._)("div",d,[(0,i.SU)(W)?((0,t.wg)(),(0,t.iD)("section",C,[(0,i.SU)(j)?((0,t.wg)(),(0,t.iD)("div",I,[(0,i.SU)(Q)?((0,t.wg)(),(0,t.iD)("div",M,"Passwords not match.")):(0,t.kq)("",!0),(0,i.SU)(X)?((0,t.wg)(),(0,t.iD)("div",K,R)):((0,t.wg)(),(0,t.iD)("div",$,[(0,t._)("div",V,[(0,t._)("div",A,[E,(0,t.wy)((0,t._)("input",{class:"input",type:"password","onUpdate:modelValue":a[4]||(a[4]=e=>(0,i.dq)(G)?G.value=e:G=e)},null,512),[[n.nr,(0,i.SU)(G)]])])]),(0,t._)("div",F,[(0,t._)("div",O,[Y,(0,t.wy)((0,t._)("input",{class:"input",type:"password","onUpdate:modelValue":a[5]||(a[5]=e=>(0,i.dq)(J)?J.value=e:J=e)},null,512),[[n.nr,(0,i.SU)(J)]])])]),(0,t._)("div",Z,[(0,t._)("div",z,[(0,t._)("button",{class:"button",onClick:ne,disabled:""==(0,i.SU)(G)&&""==(0,i.SU)(J)},"Confirm",8,L)])])]))])):((0,t.wg)(),(0,t.iD)("div",H,[(0,t._)("div",q,[(0,t._)("div",x,[T,(0,t.wy)((0,t._)("input",{class:"input",type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>(0,i.dq)(B)?B.value=e:B=e)},null,512),[[n.nr,(0,i.SU)(B)]])])]),(0,t._)("div",{class:"field"},[(0,t._)("div",{class:"control"},[(0,t._)("button",{class:"button",onClick:le},"Verify")])])]))])):((0,t.wg)(),(0,t.iD)("section",v,[p,(0,i.SU)(u)?((0,t.wg)(),(0,t.iD)("div",m,(0,l.zw)((0,i.SU)(u)),1)):(0,t.kq)("",!0),(0,i.SU)(ee)?((0,t.wg)(),(0,t.iD)("div",h,"No account has been found linked with this email.")):(0,t.kq)("",!0),(0,i.SU)(N)?((0,t.wg)(),(0,t.iD)("div",S,"You have to wait 10 minutes before requesting a code again. ")):((0,t.wg)(),(0,t.iD)("div",w,[(0,t._)("div",_,[(0,t._)("div",y,[f,(0,t.wy)((0,t._)("input",{class:"input",type:"email","onUpdate:modelValue":a[1]||(a[1]=e=>(0,i.dq)(se)?se.value=e:se=e)},null,512),[[n.nr,(0,i.SU)(se)]])])]),(0,t._)("div",g,[(0,t._)("div",b,[U,(0,t.wy)((0,t._)("input",{class:"input",type:"email","onUpdate:modelValue":a[2]||(a[2]=e=>(0,i.dq)(te)?te.value=e:te=e)},null,512),[[n.nr,(0,i.SU)(te)]])])]),(0,t._)("div",P,[(0,t._)("div",k,[(0,t._)("button",{class:(0,l.C_)(["button",{"is-loading":(0,i.SU)(s)}]),onClick:ie,disabled:null==(0,i.SU)(te)||null==(0,i.SU)(se)},"Send OTP",10,D)])])]))]))]),(0,t._)("button",{class:"modal-close is-large","aria-label":"close",onClick:a[6]||(a[6]=e=>(0,i.dq)(o)?o.value=!1:o=!1)})],2)],64))}},W=s(3744);const j=(0,W.Z)(B,[["__scopeId","data-v-c2f9401e"]]);var G=j},9868:function(e,a,s){s.r(a),s.d(a,{default:function(){return I}});var t=s(6252),i=s(9963),l=s(3577);const n=e=>((0,t.dD)("data-v-2a628776"),e=e(),(0,t.Cn)(),e),u={class:"hero is-fullheight"},r={class:"hero-body"},o={class:"container"},c={class:"container has-text-centered animate__animated animate__fadeInLeft"},d={class:"box",style:{width:"35%",margin:"auto"}},v={key:0,class:"notification is-success"},p=n((()=>(0,t._)("br",null,null,-1))),m=n((()=>(0,t._)("h1",{class:"title has-text-info has-text-centered"},"MEDIC SEARCH",-1))),h={class:"field"},w={class:"control"},_={class:"control",style:{"margin-top":"2%"}},y={key:0,class:"subtitle has-text-danger"},f={key:1,class:"subtitle has-text-danger"},g=n((()=>(0,t._)("br",null,null,-1))),b=n((()=>(0,t._)("br",null,null,-1))),U=n((()=>(0,t._)("h1",{class:"subtitle"},"OR",-1))),P=n((()=>(0,t._)("a",{href:"/user/signup"},"Create an account",-1)));function k(e,a,s,n,k,D){const S=(0,t.up)("ForgotPassword");return(0,t.wg)(),(0,t.iD)("section",u,[(0,t._)("div",r,[(0,t._)("div",o,[(0,t._)("div",c,[(0,t._)("div",d,[k.newAccount?((0,t.wg)(),(0,t.iD)("div",v,"Your account has been successfully created.")):(0,t.kq)("",!0),p,m,(0,t._)("div",h,[(0,t._)("div",w,[(0,t.wy)((0,t._)("input",{class:"input is-rounded",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>k.username=e),placeholder:"username",onKeyup:a[1]||(a[1]=(0,i.D2)(((...e)=>D.login&&D.login(...e)),["enter"])),required:""},null,544),[[i.nr,k.username]])]),(0,t._)("div",_,[(0,t.wy)((0,t._)("input",{class:"input is-rounded",type:"password","onUpdate:modelValue":a[2]||(a[2]=e=>k.password=e),placeholder:"password",onKeyup:a[3]||(a[3]=(0,i.D2)(((...e)=>D.login&&D.login(...e)),["enter"])),required:""},null,544),[[i.nr,k.password]])]),k.incorrectUserPass?((0,t.wg)(),(0,t.iD)("h1",y,(0,l.zw)(k.validateMessage),1)):0==k.incorrectUserPass?((0,t.wg)(),(0,t.iD)("h1",f,(0,l.zw)(k.validateMessage),1)):(0,t.kq)("",!0),(0,t._)("button",{type:"button",class:"button is-info is-rounded",onClick:a[4]||(a[4]=(...e)=>D.login&&D.login(...e))},"Login"),g,b,U,P]),(0,t.Wm)(S,{userType:"patient"})])])])])])}var D=s(9669),S=s.n(D),C=s(4239),H=s(9885),q={username:"UserLogin",components:{ForgotPassword:H["default"]},data(){return{username:null,password:null,userPatient:null,validateMessage:null,incorrectUserPass:Boolean,newAccount:!1}},async mounted(){1==this.$store.state.accountCreated&&(this.newAccount=!0,await this.$store.commit("accountCreated",!1)),null!==this.$store.state.patientUsername&&null!==this.$store.state.patientID&&await this.$router.push(`/user/${this.$store.state.patientUsername}`)},methods:{async login(){null==this.username||null==this.password?(this.incorrectUserPass=!1,this.validateMessage="empty username or password",this.username=null,this.password=null):await S().post("/api/auth/patient",{username:this.username,password:this.password}).then((async e=>{this.userPatient=e.data,await this.userPatient?(await S().post("/session/patient",{_id:this.userPatient._id,name:this.userPatient.name,email:this.userPatient.gmail,username:this.username,province:this.userPatient.province,city:this.userPatient.city,currentAddress:this.userPatient.currentAddress}),C.Z.commit("patientUsername",this.userPatient.username),C.Z.commit("patientID",this.userPatient._id),await this.$router.push(`/user/${this.userPatient.username}`)):(this.validateMessage="Incorrect username or password",this.incorrectUserPass=!0,this.username=null,this.password=null)}))}}},x=s(3744);const T=(0,x.Z)(q,[["render",k],["__scopeId","data-v-2a628776"]]);var I=T}}]);
//# sourceMappingURL=868.2921d8bf.js.map