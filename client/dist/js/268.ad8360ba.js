"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[268],{4268:function(a,e,l){l.r(e),l.d(e,{default:function(){return R}});var i=l(6252),s=l(2262),t=l(3577),u=l(9963),n=l(6154);const o=a=>((0,i.dD)("data-v-6278675d"),a=a(),(0,i.Cn)(),a),v=o((()=>(0,i._)("div",{class:"modal-background"},null,-1))),c={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},d={key:0,class:"section box"},r=o((()=>(0,i._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),p={key:0,class:"notification is-danger"},w={key:1,class:"notification is-warning"},f={key:2,class:"container"},_={class:"field"},m={class:"control"},y=o((()=>(0,i._)("label",{class:"label"},"Enter Username",-1))),g={class:"field"},b={class:"control"},h=o((()=>(0,i._)("label",{class:"label"},"Enter Email",-1))),k={class:"field"},H={class:"control"},D=["disabled"],P={key:3,class:"notification is-danger"},C={key:1,class:"section box"},Z={key:0,class:"container"},U={key:0,class:"notification is-warning"},q={class:"field"},V={class:"control"},x=o((()=>(0,i._)("label",{class:"label"},"Enter code",-1))),I={key:1,class:"container"},E={key:0,class:"notification is-danger"},F={key:1,class:"container"},O={class:"field"},S={class:"control"},T=o((()=>(0,i._)("label",{class:"label"},"New Password:",-1))),M={class:"field"},N={class:"control"},Y=o((()=>(0,i._)("label",{class:"label"},"Confirm Password:",-1))),z={class:"field"},j={class:"control"},A=["disabled"],B={key:2,class:"container"},G=o((()=>(0,i._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),J=[G];var K={__name:"ForgotPassword",props:{username:String,email:String,forgotPasswordPromptCount:{type:Number,default:0}},setup(a){const e=a,l=(0,s.iH)(!1),o=(0,s.iH)(""),G=(0,s.iH)(!1),K=(0,s.iH)(!1),L=(0,s.iH)(""),Q=(0,s.iH)(!1),R=(0,s.iH)(!1),W=(0,s.iH)(!1),X=(0,s.iH)(""),$=(0,s.iH)(""),aa=(0,s.iH)(!1),ea=(0,s.iH)(!1),la=(0,s.iH)(!1),ia=(0,s.iH)(!1),sa=(0,s.iH)(""),ta=(0,s.iH)(e.username),ua=(0,s.iH)(e.email),na=(0,s.iH)(""),oa=(0,s.iH)(2),va=(0,i.Fl)((()=>e.forgotPasswordPromptCount));async function ca(){if(await n.Z.post("/api/user/verify_username",{username:ta.value,email:ua.value}).then((a=>sa.value=a.data)),sa.value){la.value=!1;try{await n.Z.post("/api/OTPMail",{email:ua.value}).then(Q.value=!0),Q.value=!0,na.value="patient",ia.value=!1}catch(a){o.value=a}}else la.value=!0}async function da(){if(await n.Z.post("/api/doctor/verify_username",{username:ta.value,email:ua.value}).then((a=>sa.value=a.data)),sa.value){la.value=!1;try{await n.Z.post("/api/OTPMail",{email:ua.value}).then(Q.value=!0),Q.value=!0,na.value="doctor",ia.value=!1}catch(a){o.value=a}}else la.value=!0}async function ra(){if(await n.Z.post("/api/manager/verify_username",{username:ta.value,email:ua.value}).then((a=>sa.value=a.data)),sa.value){la.value=!1;try{await n.Z.post("/api/OTPMail",{email:ua.value}).then(Q.value=!0),Q.value=!0,na.value="provider",ia.value=!1}catch(a){o.value=a}}else la.value=!0}async function pa(){if(null!=ta.value||null!=ua.value){let a;if(l.value=!0,await n.Z.post("/api/code/email",{email:ua.value}).then((e=>a=e.data)),a)K.value=!0;else{K.value=!1,ia.value=!0;while(ia.value)await ca(),await da(),await ra(),ia.value=!1}l.value=!1}}async function wa(){let a;W.value=!1,R.value=!1,await n.Z.post("/api/code/verify",{code:L.value}).then((e=>a=e.data)),a?R.value=!0:W.value=!0}async function fa(){if(X.value===$.value){if("patient"==na.value)try{await n.Z.put("/api/fupdatePassword/patient",{patientID:sa.value._id,password:X.value}),sa.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,sa.value=""}else if("doctor"==na.value)try{await n.Z.put("/api/fupdatePassword/doctor",{doctorID:sa.value._id,password:X.value}),sa.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,sa.value=""}else if("provider"==na.value)try{await n.Z.put("/api/fupdatePassword/manager",{managerID:sa.value._id,password:X.value}),sa.value="",ea.value=!0}catch(a){ea.value=!1,o.value=a,sa.value=""}}else aa.value=!0}return(a,e)=>((0,i.wg)(),(0,i.iD)(i.HY,null,[(0,s.SU)(va)>=oa.value?((0,i.wg)(),(0,i.iD)("a",{key:0,class:"help has-text-danger",onClick:e[0]||(e[0]=a=>G.value=!G.value)},"Forgot Password")):(0,i.kq)("",!0),(0,i._)("div",{class:(0,t.C_)(["modal",{"is-active":G.value}])},[v,(0,i._)("div",c,[Q.value?((0,i.wg)(),(0,i.iD)("section",C,[R.value?((0,i.wg)(),(0,i.iD)("div",I,[aa.value?((0,i.wg)(),(0,i.iD)("div",E,"Passwords not match.")):(0,i.kq)("",!0),ea.value?((0,i.wg)(),(0,i.iD)("div",B,J)):((0,i.wg)(),(0,i.iD)("div",F,[(0,i._)("div",O,[(0,i._)("div",S,[T,(0,i.wy)((0,i._)("input",{class:"input",type:"password","onUpdate:modelValue":e[4]||(e[4]=a=>X.value=a)},null,512),[[u.nr,X.value]])])]),(0,i._)("div",M,[(0,i._)("div",N,[Y,(0,i.wy)((0,i._)("input",{class:"input",type:"password","onUpdate:modelValue":e[5]||(e[5]=a=>$.value=a)},null,512),[[u.nr,$.value]])])]),(0,i._)("div",z,[(0,i._)("div",j,[(0,i._)("button",{class:"button",onClick:fa,disabled:""==X.value&&""==$.value},"Confirm",8,A)])])]))])):((0,i.wg)(),(0,i.iD)("div",Z,[W.value?((0,i.wg)(),(0,i.iD)("div",U,"Incorrect code, please try again.")):(0,i.kq)("",!0),(0,i._)("div",q,[(0,i._)("div",V,[x,(0,i.wy)((0,i._)("input",{class:"input",type:"number","onUpdate:modelValue":e[3]||(e[3]=a=>L.value=a)},null,512),[[u.nr,L.value]])])]),(0,i._)("div",{class:"field"},[(0,i._)("div",{class:"control"},[(0,i._)("button",{class:"button",onClick:wa},"Verify")])])]))])):((0,i.wg)(),(0,i.iD)("section",d,[r,o.value?((0,i.wg)(),(0,i.iD)("div",p,(0,t.zw)(o.value),1)):(0,i.kq)("",!0),la.value?((0,i.wg)(),(0,i.iD)("div",w,"No account has been found linked with this email.")):(0,i.kq)("",!0),K.value?((0,i.wg)(),(0,i.iD)("div",P,"You have to wait 10 minutes before requesting a code again. ")):((0,i.wg)(),(0,i.iD)("div",f,[(0,i._)("div",_,[(0,i._)("div",m,[y,(0,i.wy)((0,i._)("input",{class:"input",type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>ta.value=a)},null,512),[[u.nr,ta.value]])])]),(0,i._)("div",g,[(0,i._)("div",b,[h,(0,i.wy)((0,i._)("input",{class:"input",type:"email","onUpdate:modelValue":e[2]||(e[2]=a=>ua.value=a)},null,512),[[u.nr,ua.value]])])]),(0,i._)("div",k,[(0,i._)("div",H,[(0,i._)("button",{class:(0,t.C_)(["button",{"is-loading":l.value}]),onClick:pa,disabled:null==ua.value||null==ta.value},"Send OTP",10,D)])])]))]))]),(0,i._)("button",{class:"modal-close is-large","aria-label":"close",onClick:e[6]||(e[6]=a=>G.value=!1)})],2)],64))}},L=l(3744);const Q=(0,L.Z)(K,[["__scopeId","data-v-6278675d"]]);var R=Q}}]);
//# sourceMappingURL=268.ad8360ba.js.map