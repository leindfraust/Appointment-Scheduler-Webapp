"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[974,848],{2848:function(e,a,s){s.r(a),s.d(a,{default:function(){return J}});var t=s(6252),i=s(2262),l=s(3577),n=s(9963),u=s(9669),r=s.n(u);const o=e=>((0,t.dD)("data-v-29b358e4"),e=e(),(0,t.Cn)(),e),c=o((()=>(0,t._)("div",{class:"modal-background"},null,-1))),d={class:"modal-content has-text-left",style:{width:"40%",margin:"auto"}},v={key:0,class:"section box"},p=o((()=>(0,t._)("p",{class:"title is-4 has-text-danger"},"Forgot Password",-1))),m={key:0,class:"notification is-danger"},w={key:1,class:"notification is-warning"},h={key:2,class:"container"},_={class:"field"},y={class:"control"},g=o((()=>(0,t._)("label",{class:"label"},"Enter Username",-1))),f={class:"field"},b={class:"control"},U=o((()=>(0,t._)("label",{class:"label"},"Enter Email",-1))),k={class:"field"},P={class:"control"},D=["disabled"],S={key:3,class:"notification is-danger"},C={key:1,class:"section box"},H={key:0,class:"container"},q={key:0,class:"notification is-warning"},x={class:"field"},T={class:"control"},I=o((()=>(0,t._)("label",{class:"label"},"Enter code",-1))),M={key:1,class:"container"},$={key:0,class:"notification is-danger"},V={key:1,class:"container"},A={class:"field"},E={class:"control"},F=o((()=>(0,t._)("label",{class:"label"},"New Password:",-1))),O={class:"field"},Y={class:"control"},Z=o((()=>(0,t._)("label",{class:"label"},"Confirm Password:",-1))),z={class:"field"},L={class:"control"},K=["disabled"],N={key:2,class:"container"},R=o((()=>(0,t._)("div",{class:"notification is-success"},"Your password has been successfully changed.",-1))),B=[R];var W={__name:"ForgotPassword",props:{userType:String,username:String,email:String},setup(e){const a=e;let s=(0,i.iH)(!1),u=(0,i.iH)(""),o=(0,i.iH)(!1),R=(0,i.iH)(!1),W=(0,i.iH)(""),j=(0,i.iH)(!1),G=(0,i.iH)(!1),J=(0,i.iH)(!1),Q=(0,i.iH)(""),X=(0,i.iH)(""),ee=(0,i.iH)(!1),ae=(0,i.iH)(!1),se=(0,i.iH)(!1),te=(0,i.iH)(""),ie=(0,i.iH)(a.username),le=(0,i.iH)(a.email);async function ne(){if(null!=ie.value||null!=le.value){let t;if(s.value=!0,await r().post("/api/code/email",{email:le.value}).then((e=>t=e.data)),t)R.value=!0;else if(R.value=!1,"patient"==a.userType)if(await r().post("/api/user/verify_username",{username:ie.value,email:le.value}).then((e=>te.value=e.data)),te.value){se.value=!1;try{await r().post("/api/OTPMail",{email:le.value}).then(j.value=!0),j.value=!0}catch(e){u.value=e}}else se.value=!0;else if("doctor"==a.userType)if(await r().post("/api/doctor/verify_username",{username:ie.value,email:le.value}).then((e=>te.value=e.data)),te.value){se.value=!1;try{await r().post("/api/OTPMail",{email:le.value}).then(j.value=!0),j.value=!0}catch(e){u.value=e}}else se.value=!0;else if("manager"==a.userType)if(await r().post("/api/manager/verify_username",{username:ie.value,email:le.value}).then((e=>te.value=e.data)),te.value){se.value=!1;try{await r().post("/api/OTPMail",{email:le.value}).then(j.value=!0),j.value=!0}catch(e){u.value=e}}else se.value=!0;s.value=!1}}async function ue(){let e;J.value=!1,G.value=!1,await r().post("/api/code/verify",{code:W.value}).then((a=>e=a.data)),e?G.value=!0:J.value=!0}async function re(){if(Q.value===X.value){if("patient"==a.userType)try{await r().put("/api/fupdatePassword/patient",{patientID:te.value._id,password:Q.value}),te.value="",ae.value=!0}catch(e){ae.value=!1,u.value=e,te.value=""}else if("doctor"==a.userType)try{await r().put("/api/fupdatePassword/doctor",{doctorID:te.value._id,password:Q.value}),te.value="",ae.value=!0}catch(e){ae.value=!1,u.value=e,te.value=""}else if("manager"==a.userType)try{await r().put("/api/fupdatePassword/manager",{managerID:te.value._id,password:Q.value}),te.value="",ae.value=!0}catch(e){ae.value=!1,u.value=e,te.value=""}}else ee.value=!0}return(e,a)=>((0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t._)("a",{class:"subtitle has-text-danger",onClick:a[0]||(a[0]=e=>(0,i.dq)(o)?o.value=!(0,i.SU)(o):o=!(0,i.SU)(o))},"Forgot Password"),(0,t._)("div",{class:(0,l.C_)(["modal",{"is-active":(0,i.SU)(o)}])},[c,(0,t._)("div",d,[(0,i.SU)(j)?((0,t.wg)(),(0,t.iD)("section",C,[(0,i.SU)(G)?((0,t.wg)(),(0,t.iD)("div",M,[(0,i.SU)(ee)?((0,t.wg)(),(0,t.iD)("div",$,"Passwords not match.")):(0,t.kq)("",!0),(0,i.SU)(ae)?((0,t.wg)(),(0,t.iD)("div",N,B)):((0,t.wg)(),(0,t.iD)("div",V,[(0,t._)("div",A,[(0,t._)("div",E,[F,(0,t.wy)((0,t._)("input",{class:"input",type:"password","onUpdate:modelValue":a[4]||(a[4]=e=>(0,i.dq)(Q)?Q.value=e:Q=e)},null,512),[[n.nr,(0,i.SU)(Q)]])])]),(0,t._)("div",O,[(0,t._)("div",Y,[Z,(0,t.wy)((0,t._)("input",{class:"input",type:"password","onUpdate:modelValue":a[5]||(a[5]=e=>(0,i.dq)(X)?X.value=e:X=e)},null,512),[[n.nr,(0,i.SU)(X)]])])]),(0,t._)("div",z,[(0,t._)("div",L,[(0,t._)("button",{class:"button",onClick:re,disabled:""==(0,i.SU)(Q)&&""==(0,i.SU)(X)},"Confirm",8,K)])])]))])):((0,t.wg)(),(0,t.iD)("div",H,[(0,i.SU)(J)?((0,t.wg)(),(0,t.iD)("div",q,"Incorrect code, please try again.")):(0,t.kq)("",!0),(0,t._)("div",x,[(0,t._)("div",T,[I,(0,t.wy)((0,t._)("input",{class:"input",type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>(0,i.dq)(W)?W.value=e:W=e)},null,512),[[n.nr,(0,i.SU)(W)]])])]),(0,t._)("div",{class:"field"},[(0,t._)("div",{class:"control"},[(0,t._)("button",{class:"button",onClick:ue},"Verify")])])]))])):((0,t.wg)(),(0,t.iD)("section",v,[p,(0,i.SU)(u)?((0,t.wg)(),(0,t.iD)("div",m,(0,l.zw)((0,i.SU)(u)),1)):(0,t.kq)("",!0),(0,i.SU)(se)?((0,t.wg)(),(0,t.iD)("div",w,"No account has been found linked with this email.")):(0,t.kq)("",!0),(0,i.SU)(R)?((0,t.wg)(),(0,t.iD)("div",S,"You have to wait 10 minutes before requesting a code again. ")):((0,t.wg)(),(0,t.iD)("div",h,[(0,t._)("div",_,[(0,t._)("div",y,[g,(0,t.wy)((0,t._)("input",{class:"input",type:"email","onUpdate:modelValue":a[1]||(a[1]=e=>(0,i.dq)(ie)?ie.value=e:ie=e)},null,512),[[n.nr,(0,i.SU)(ie)]])])]),(0,t._)("div",f,[(0,t._)("div",b,[U,(0,t.wy)((0,t._)("input",{class:"input",type:"email","onUpdate:modelValue":a[2]||(a[2]=e=>(0,i.dq)(le)?le.value=e:le=e)},null,512),[[n.nr,(0,i.SU)(le)]])])]),(0,t._)("div",k,[(0,t._)("div",P,[(0,t._)("button",{class:(0,l.C_)(["button",{"is-loading":(0,i.SU)(s)}]),onClick:ne,disabled:null==(0,i.SU)(le)||null==(0,i.SU)(ie)},"Send OTP",10,D)])])]))]))]),(0,t._)("button",{class:"modal-close is-large","aria-label":"close",onClick:a[6]||(a[6]=e=>(0,i.dq)(o)?o.value=!1:o=!1)})],2)],64))}},j=s(3744);const G=(0,j.Z)(W,[["__scopeId","data-v-29b358e4"]]);var J=G},7220:function(e,a,s){s.r(a),s.d(a,{default:function(){return I}});var t=s(6252),i=s(9963),l=s(3577);const n=e=>((0,t.dD)("data-v-a063123e"),e=e(),(0,t.Cn)(),e),u={class:"hero is-fullheight"},r={class:"hero-body"},o={class:"container"},c={class:"container has-text-centered animate__animated animate__fadeInLeft"},d={class:"box",style:{width:"35%",margin:"auto"}},v={key:0,class:"notification is-success"},p=n((()=>(0,t._)("br",null,null,-1))),m=n((()=>(0,t._)("h1",{class:"title has-text-info has-text-centered"},"MEDIC SEARCH",-1))),w={class:"field"},h={class:"control"},_={class:"control",style:{"margin-top":"2%"}},y={key:0,class:"subtitle has-text-danger"},g={key:1,class:"subtitle has-text-danger"},f=n((()=>(0,t._)("br",null,null,-1))),b=n((()=>(0,t._)("br",null,null,-1))),U=n((()=>(0,t._)("h1",{class:"subtitle"},"OR",-1))),k=n((()=>(0,t._)("a",{href:"/user/signup"},"Create an account",-1)));function P(e,a,s,n,P,D){const S=(0,t.up)("ForgotPassword");return(0,t.wg)(),(0,t.iD)("section",u,[(0,t._)("div",r,[(0,t._)("div",o,[(0,t._)("div",c,[(0,t._)("div",d,[P.newAccount?((0,t.wg)(),(0,t.iD)("div",v,"Your account has been successfully created.")):(0,t.kq)("",!0),p,m,(0,t._)("div",w,[(0,t._)("div",h,[(0,t.wy)((0,t._)("input",{class:"input is-rounded",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>P.username=e),placeholder:"username",onKeyup:a[1]||(a[1]=(0,i.D2)(((...e)=>D.login&&D.login(...e)),["enter"])),required:""},null,544),[[i.nr,P.username]])]),(0,t._)("div",_,[(0,t.wy)((0,t._)("input",{class:"input is-rounded",type:"password","onUpdate:modelValue":a[2]||(a[2]=e=>P.password=e),placeholder:"password",onKeyup:a[3]||(a[3]=(0,i.D2)(((...e)=>D.login&&D.login(...e)),["enter"])),required:""},null,544),[[i.nr,P.password]])]),P.incorrectUserPass?((0,t.wg)(),(0,t.iD)("h1",y,(0,l.zw)(P.validateMessage),1)):0==P.incorrectUserPass?((0,t.wg)(),(0,t.iD)("h1",g,(0,l.zw)(P.validateMessage),1)):(0,t.kq)("",!0),(0,t._)("button",{type:"button",class:"button is-info is-rounded",onClick:a[4]||(a[4]=(...e)=>D.login&&D.login(...e))},"Login"),f,b,U,k]),(0,t.Wm)(S,{userType:"patient"})])])])])])}var D=s(9669),S=s.n(D),C=s(4239),H=s(2848),q={username:"UserLogin",components:{ForgotPassword:H["default"]},data(){return{username:null,password:null,userPatient:null,validateMessage:null,incorrectUserPass:Boolean,newAccount:!1}},async mounted(){1==this.$store.state.accountCreated&&(this.newAccount=!0,await this.$store.commit("accountCreated",!1))},async beforeCreate(){await S().get("/session/patient").then((async e=>{"undefined"!==typeof e.data.username&&(this.$store.commit("patientUsername",e.data.username),this.$store.commit("patientID",e.data._id),await this.$router.push(`/user/${this.$store.state.patientUsername}`))}))},methods:{async login(){null==this.username||null==this.password?(this.incorrectUserPass=!1,this.validateMessage="empty username or password",this.username=null,this.password=null):await S().post("/api/auth/patient",{username:this.username,password:this.password}).then((async e=>{this.userPatient=e.data,await this.userPatient?(await S().post("/session/patient",{_id:this.userPatient._id,name:this.userPatient.name,email:this.userPatient.gmail,username:this.username,province:this.userPatient.province,city:this.userPatient.city,currentAddress:this.userPatient.currentAddress}),C.Z.commit("patientUsername",this.userPatient.username),C.Z.commit("patientID",this.userPatient._id),await this.$router.push(`/user/${this.userPatient.username}`)):(this.validateMessage="Incorrect username or password",this.incorrectUserPass=!0,this.username=null,this.password=null)}))}}},x=s(3744);const T=(0,x.Z)(q,[["render",P],["__scopeId","data-v-a063123e"]]);var I=T}}]);
//# sourceMappingURL=974.c4259d2e.js.map